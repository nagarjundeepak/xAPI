/*! Copyright 2012-2019 Rustici Software, LLC All Rights Reserved. xapi-bookmarklet 4.0.0 2019-04-22T13:51:57-0500 9c58830eaa4e9238f20e60a17682c97506af67b8 */
var CryptoJS=CryptoJS ||function(s,t){function n(){}var e={},i=e.lib={},r=i.Base={extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},l=i.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var r=0;r<t;r++)e[i+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<n.length)for(r=0;r<t;r+=4)e[i+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=s.ceil(e/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(4294967296*s.random()|0);return new l.init(e,t)}}),o=e.enc={},a=o.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var r=e[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new l.init(n,e/2)}},c=o.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++)n.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new l.init(n,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},h=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,i=e.sigBytes,r=this.blockSize,o=i/(4*r);if(t=(o=t?s.ceil(o):s.max((0|o)-this._minBufferSize,0))*r,i=s.min(4*t,i),t){for(var a=0;a<t;a+=r)this._doProcessBlock(n,a);a=n.splice(0,t),e.sigBytes-=i}return new l.init(a,i)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=h.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new p.HMAC.init(n,e).finalize(t)}}});var p=e.algo={};return e}(Math);!function(){var t=CryptoJS,e=(i=t.lib).WordArray,n=i.Hasher,u=[],i=t.algo.SHA1=n.extend({_doReset:function(){this._hash=new e.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=0;l<80;l++){if(l<16)u[l]=0|t[e+l];else{var c=u[l-3]^u[l-8]^u[l-14]^u[l-16];u[l]=c<<1|c>>>31}c=(i<<5|i>>>27)+s+u[l],c=l<20?c+(1518500249+(r&o|~r&a)):l<40?c+(1859775393+(r^o^a)):l<60?c+((r&o|r&a|o&a)-1894007588):c+((r^o^a)-899497514),s=a,a=o,o=r<<30|r>>>2,r=i,i=c}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(64+i>>>9<<4)]=Math.floor(n/4294967296),e[15+(64+i>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=n.clone.call(this);return t._hash=this._hash.clone(),t}});t.SHA1=n._createHelper(i),t.HmacSHA1=n._createHmacHelper(i)}();var CryptoJS=CryptoJS||function(s,t){function n(){}var e={},i=e.lib={},r=i.Base={extend:function(t){n.prototype=this;var e=new n;return t&&e.mixIn(t),e.hasOwnProperty("init")||(e.init=function(){e.$super.init.apply(this,arguments)}),(e.init.prototype=e).$super=this,e},create:function(){var t=this.extend();return t.init.apply(t,arguments),t},init:function(){},mixIn:function(t){for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);t.hasOwnProperty("toString")&&(this.toString=t.toString)},clone:function(){return this.init.prototype.extend(this)}},l=i.WordArray=r.extend({init:function(t,e){t=this.words=t||[],this.sigBytes=null!=e?e:4*t.length},toString:function(t){return(t||a).stringify(this)},concat:function(t){var e=this.words,n=t.words,i=this.sigBytes;if(t=t.sigBytes,this.clamp(),i%4)for(var r=0;r<t;r++)e[i+r>>>2]|=(n[r>>>2]>>>24-r%4*8&255)<<24-(i+r)%4*8;else if(65535<n.length)for(r=0;r<t;r+=4)e[i+r>>>2]=n[r>>>2];else e.push.apply(e,n);return this.sigBytes+=t,this},clamp:function(){var t=this.words,e=this.sigBytes;t[e>>>2]&=4294967295<<32-e%4*8,t.length=s.ceil(e/4)},clone:function(){var t=r.clone.call(this);return t.words=this.words.slice(0),t},random:function(t){for(var e=[],n=0;n<t;n+=4)e.push(4294967296*s.random()|0);return new l.init(e,t)}}),o=e.enc={},a=o.Hex={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++){var r=e[i>>>2]>>>24-i%4*8&255;n.push((r>>>4).toString(16)),n.push((15&r).toString(16))}return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i+=2)n[i>>>3]|=parseInt(t.substr(i,2),16)<<24-i%8*4;return new l.init(n,e/2)}},c=o.Latin1={stringify:function(t){var e=t.words;t=t.sigBytes;for(var n=[],i=0;i<t;i++)n.push(String.fromCharCode(e[i>>>2]>>>24-i%4*8&255));return n.join("")},parse:function(t){for(var e=t.length,n=[],i=0;i<e;i++)n[i>>>2]|=(255&t.charCodeAt(i))<<24-i%4*8;return new l.init(n,e)}},u=o.Utf8={stringify:function(t){try{return decodeURIComponent(escape(c.stringify(t)))}catch(t){throw Error("Malformed UTF-8 data")}},parse:function(t){return c.parse(unescape(encodeURIComponent(t)))}},h=i.BufferedBlockAlgorithm=r.extend({reset:function(){this._data=new l.init,this._nDataBytes=0},_append:function(t){"string"==typeof t&&(t=u.parse(t)),this._data.concat(t),this._nDataBytes+=t.sigBytes},_process:function(t){var e=this._data,n=e.words,i=e.sigBytes,r=this.blockSize,o=i/(4*r);if(t=(o=t?s.ceil(o):s.max((0|o)-this._minBufferSize,0))*r,i=s.min(4*t,i),t){for(var a=0;a<t;a+=r)this._doProcessBlock(n,a);a=n.splice(0,t),e.sigBytes-=i}return new l.init(a,i)},clone:function(){var t=r.clone.call(this);return t._data=this._data.clone(),t},_minBufferSize:0});i.Hasher=h.extend({cfg:r.extend(),init:function(t){this.cfg=this.cfg.extend(t),this.reset()},reset:function(){h.reset.call(this),this._doReset()},update:function(t){return this._append(t),this._process(),this},finalize:function(t){return t&&this._append(t),this._doFinalize()},blockSize:16,_createHelper:function(n){return function(t,e){return new n.init(e).finalize(t)}},_createHmacHelper:function(n){return function(t,e){return new p.HMAC.init(n,e).finalize(t)}}});var p=e.algo={};return e}(Math),TinCan;!function(r){function t(t){return 4294967296*(t-(0|t))|0}for(var e=CryptoJS,n=(o=e.lib).WordArray,i=o.Hasher,o=e.algo,a=[],d=[],s=2,l=0;l<64;){var c;t:{c=s;for(var u=r.sqrt(c),h=2;h<=u;h++)if(!(c%h)){c=!1;break t}c=!0}c&&(l<8&&(a[l]=t(r.pow(s,.5))),d[l]=t(r.pow(s,1/3)),l++),s++}var g=[];o=o.SHA256=i.extend({_doReset:function(){this._hash=new n.init(a.slice(0))},_doProcessBlock:function(t,e){for(var n=this._hash.words,i=n[0],r=n[1],o=n[2],a=n[3],s=n[4],l=n[5],c=n[6],u=n[7],h=0;h<64;h++){if(h<16)g[h]=0|t[e+h];else{var p=g[h-15],f=g[h-2];g[h]=((p<<25|p>>>7)^(p<<14|p>>>18)^p>>>3)+g[h-7]+((f<<15|f>>>17)^(f<<13|f>>>19)^f>>>10)+g[h-16]}p=u+((s<<26|s>>>6)^(s<<21|s>>>11)^(s<<7|s>>>25))+(s&l^~s&c)+d[h]+g[h],f=((i<<30|i>>>2)^(i<<19|i>>>13)^(i<<10|i>>>22))+(i&r^i&o^r&o),u=c,c=l,l=s,s=a+p|0,a=o,o=r,r=i,i=p+f|0}n[0]=n[0]+i|0,n[1]=n[1]+r|0,n[2]=n[2]+o|0,n[3]=n[3]+a|0,n[4]=n[4]+s|0,n[5]=n[5]+l|0,n[6]=n[6]+c|0,n[7]=n[7]+u|0},_doFinalize:function(){var t=this._data,e=t.words,n=8*this._nDataBytes,i=8*t.sigBytes;return e[i>>>5]|=128<<24-i%32,e[14+(64+i>>>9<<4)]=r.floor(n/4294967296),e[15+(64+i>>>9<<4)]=n,t.sigBytes=4*e.length,this._process(),this._hash},clone:function(){var t=i.clone.call(this);return t._hash=this._hash.clone(),t}});e.SHA256=i._createHelper(o),e.HmacSHA256=i._createHmacHelper(o)}(Math),function(){var t=CryptoJS,u=t.lib.WordArray;t.enc.Base64={stringify:function(t){var e=t.words,n=t.sigBytes,i=this._map;t.clamp();for(var r=[],o=0;o<n;o+=3)for(var a=(e[o>>>2]>>>24-o%4*8&255)<<16|(e[o+1>>>2]>>>24-(o+1)%4*8&255)<<8|e[o+2>>>2]>>>24-(o+2)%4*8&255,s=0;s<4&&o+.75*s<n;s++)r.push(i.charAt(a>>>6*(3-s)&63));var l=i.charAt(64);if(l)for(;r.length%4;)r.push(l);return r.join("")},parse:function(t){var e=t.length,n=this._map,i=n.charAt(64);if(i){var r=t.indexOf(i);-1!=r&&(e=r)}for(var o=[],a=0,s=0;s<e;s++)if(s%4){var l=n.indexOf(t.charAt(s-1))<<s%4*2,c=n.indexOf(t.charAt(s))>>>6-s%4*2;o[a>>>2]|=(l|c)<<24-a%4*8,a++}return u.create(o,a)},_map:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/="}}(),function(){if("function"==typeof ArrayBuffer){var t=CryptoJS.lib.WordArray,r=t.init;(t.init=function(t){if(t instanceof ArrayBuffer&&(t=new Uint8Array(t)),(t instanceof Int8Array||t instanceof Uint8ClampedArray||t instanceof Int16Array||t instanceof Uint16Array||t instanceof Int32Array||t instanceof Uint32Array||t instanceof Float32Array||t instanceof Float64Array)&&(t=new Uint8Array(t.buffer,t.byteOffset,t.byteLength)),t instanceof Uint8Array){for(var e=t.byteLength,n=[],i=0;i<e;i++)n[i>>>2]|=t[i]<<24-i%4*8;r.call(this,n,e)}else r.apply(this,arguments)}).prototype=t}}(),function(){"use strict";var l={statementId:!0,voidedStatementId:!0,verb:!0,object:!0,registration:!0,context:!0,actor:!0,since:!0,until:!0,limit:!0,authoritative:!0,sparse:!0,instructor:!0,ascending:!0,continueToken:!0,agent:!0,activityId:!0,stateId:!0,profileId:!0,activity_platform:!0,grouping:!0,"Accept-Language":!0};(TinCan=function(t){this.log("constructor"),this.recordStores=[],this.actor=null,this.activity=null,this.registration=null,this.context=null,this.init(t)}).prototype={LOG_SRC:"TinCan",log:function(t,e){TinCan.DEBUG&&"undefined"!=typeof console&&console.log&&(e=e||this.LOG_SRC||"TinCan",console.log("TinCan."+e+": "+t))},init:function(t){var e;if(this.log("init"),(t=t||{}).hasOwnProperty("url")&&""!==t.url&&this._initFromQueryString(t.url),t.hasOwnProperty("recordStores")&&void 0!==t.recordStores)for(e=0;e<t.recordStores.length;e+=1)this.addRecordStore(t.recordStores[e]);t.hasOwnProperty("activity")&&(t.activity instanceof TinCan.Activity?this.activity=t.activity:this.activity=new TinCan.Activity(t.activity)),t.hasOwnProperty("actor")&&(t.actor instanceof TinCan.Agent?this.actor=t.actor:this.actor=new TinCan.Agent(t.actor)),t.hasOwnProperty("context")&&(t.context instanceof TinCan.Context?this.context=t.context:this.context=new TinCan.Context(t.context)),t.hasOwnProperty("registration")&&(this.registration=t.registration)},_initFromQueryString:function(t){this.log("_initFromQueryString");var e,n,i,r=TinCan.Utils.parseURL(t).params,o=["endpoint","auth"],a={},s=null;if(r.hasOwnProperty("actor")){this.log("_initFromQueryString - found actor: "+r.actor);try{this.actor=TinCan.Agent.fromJSON(r.actor),delete r.actor}catch(t){this.log("_initFromQueryString - failed to set actor: "+t)}}if(r.hasOwnProperty("activity_id")&&(this.activity=new TinCan.Activity({id:r.activity_id}),delete r.activity_id),(r.hasOwnProperty("activity_platform")||r.hasOwnProperty("registration")||r.hasOwnProperty("grouping"))&&(i={},r.hasOwnProperty("activity_platform")&&(i.platform=r.activity_platform,delete r.activity_platform),r.hasOwnProperty("registration")&&(i.registration=this.registration=r.registration,delete r.registration),r.hasOwnProperty("grouping")&&(i.contextActivities={},i.contextActivities.grouping=r.grouping,delete r.grouping),this.context=new TinCan.Context(i)),r.hasOwnProperty("endpoint")){for(e=0;e<o.length;e+=1)n=o[e],r.hasOwnProperty(n)&&(a[n]=r[n],delete r[n]);for(e in r)r.hasOwnProperty(e)&&(l.hasOwnProperty(e)?delete r[e]:(s=s||{})[e]=r[e]);null!==s&&(a.extended=s),a.allowFail=!1,this.addRecordStore(a)}},addRecordStore:function(t){var e;this.log("addRecordStore"),e=t instanceof TinCan.LRS?t:new TinCan.LRS(t),this.recordStores.push(e)},prepareStatement:function(t){return this.log("prepareStatement"),t instanceof TinCan.Statement||(t=new TinCan.Statement(t)),null===t.actor&&null!==this.actor&&(t.actor=this.actor),null===t.target&&null!==this.activity&&(t.target=this.activity),null!==this.context&&(null===t.context?t.context=this.context:(null===t.context.registration&&(t.context.registration=this.context.registration),null===t.context.platform&&(t.context.platform=this.context.platform),null!==this.context.contextActivities&&(null===t.context.contextActivities?t.context.contextActivities=this.context.contextActivities:(null!==this.context.contextActivities.grouping&&null===t.context.contextActivities.grouping&&(t.context.contextActivities.grouping=this.context.contextActivities.grouping),null!==this.context.contextActivities.parent&&null===t.context.contextActivities.parent&&(t.context.contextActivities.parent=this.context.contextActivities.parent),null!==this.context.contextActivities.other&&null===t.context.contextActivities.other&&(t.context.contextActivities.other=this.context.contextActivities.other))))),t},sendStatement:function(t,i){this.log("sendStatement");var e,n,r,o=this,a=this.prepareStatement(t),s=this.recordStores.length,l=[],c=[];if(0<s)for("function"==typeof i&&(r=function(t,e){var n;o.log("sendStatement - callbackWrapper: "+s),1<s?(s-=1,c.push({err:t,xhr:e})):1===s?(c.push({err:t,xhr:e}),n=[c,a],i.apply(this,n)):o.log("sendStatement - unexpected record store count: "+s)}),n=0;n<s;n+=1)e=this.recordStores[n],l.push(e.saveStatement(a,{callback:r}));else this.log("[warning] sendStatement: No LRSs added yet (statement not sent)"),"function"==typeof i&&i.apply(this,[null,a]);return{statement:a,results:l}},getStatement:function(t,e,n){if(this.log("getStatement"),(n=n||{}).params=n.params||{},0<this.recordStores.length)return this.recordStores[0].retrieveStatement(t,{callback:e,params:n.params});this.log("[warning] getStatement: No LRSs added yet (statement not retrieved)")},voidStatement:function(t,i,e){this.log("voidStatement");var n,r,o,a,s,l=this,c=this.recordStores.length,u=[],h=[];if(t instanceof TinCan.Statement&&(t=t.id),void 0!==e.actor?r=e.actor:null!==this.actor&&(r=this.actor),o=new TinCan.Statement({actor:r,verb:{id:"http://adlnet.gov/expapi/verbs/voided"},target:{objectType:"StatementRef",id:t}}),0<c)for("function"==typeof i&&(s=function(t,e){var n;l.log("voidStatement - callbackWrapper: "+c),1<c?(c-=1,h.push({err:t,xhr:e})):1===c?(h.push({err:t,xhr:e}),n=[h,o],i.apply(this,n)):l.log("voidStatement - unexpected record store count: "+c)}),a=0;a<c;a+=1)n=this.recordStores[a],u.push(n.saveStatement(o,{callback:s}));else this.log("[warning] voidStatement: No LRSs added yet (statement not sent)"),"function"==typeof i&&i.apply(this,[null,o]);return{statement:o,results:u}},getVoidedStatement:function(t,e){if(this.log("getVoidedStatement"),0<this.recordStores.length)return this.recordStores[0].retrieveVoidedStatement(t,{callback:e});this.log("[warning] getVoidedStatement: No LRSs added yet (statement not retrieved)")},sendStatements:function(t,i){this.log("sendStatements");var e,n,r,o=this,a=[],s=this.recordStores.length,l=[],c=[];if(0===t.length)"function"==typeof i&&i.apply(this,[null,a]);else{for(n=0;n<t.length;n+=1)a.push(this.prepareStatement(t[n]));if(0<s)for("function"==typeof i&&(r=function(t,e){var n;o.log("sendStatements - callbackWrapper: "+s),1<s?(s-=1,c.push({err:t,xhr:e})):1===s?(c.push({err:t,xhr:e}),n=[c,a],i.apply(this,n)):o.log("sendStatements - unexpected record store count: "+s)}),n=0;n<s;n+=1)e=this.recordStores[n],l.push(e.saveStatements(a,{callback:r}));else this.log("[warning] sendStatements: No LRSs added yet (statements not sent)"),"function"==typeof i&&i.apply(this,[null,a])}return{statements:a,results:l}},getStatements:function(t){this.log("getStatements");var e,n,i={};if(0<this.recordStores.length)return e=this.recordStores[0],n=(t=t||{}).params||{},t.sendActor&&null!==this.actor&&("0.9"===e.version||"0.95"===e.version?n.actor=this.actor:n.agent=this.actor),t.sendActivity&&null!==this.activity&&("0.9"===e.version||"0.95"===e.version?n.target=this.activity:n.activity=this.activity),void 0===n.registration&&null!==this.registration&&(n.registration=this.registration),i={params:n},void 0!==t.callback&&(i.callback=t.callback),e.queryStatements(i);this.log("[warning] getStatements: No LRSs added yet (statements not read)")},getState:function(t,e){var n,i;if(this.log("getState"),0<this.recordStores.length)return i=this.recordStores[0],n={agent:void 0!==(e=e||{}).agent?e.agent:this.actor,activity:void 0!==e.activity?e.activity:this.activity},void 0!==e.registration?n.registration=e.registration:null!==this.registration&&(n.registration=this.registration),void 0!==e.callback&&(n.callback=e.callback),i.retrieveState(t,n);this.log("[warning] getState: No LRSs added yet (state not retrieved)")},setState:function(t,e,n){var i,r;if(this.log("setState"),0<this.recordStores.length)return r=this.recordStores[0],i={agent:void 0!==(n=n||{}).agent?n.agent:this.actor,activity:void 0!==n.activity?n.activity:this.activity},void 0!==n.registration?i.registration=n.registration:null!==this.registration&&(i.registration=this.registration),void 0!==n.lastSHA1&&(i.lastSHA1=n.lastSHA1),void 0!==n.contentType&&(i.contentType=n.contentType,void 0!==n.overwriteJSON&&!n.overwriteJSON&&TinCan.Utils.isApplicationJSON(n.contentType)&&(i.method="POST")),void 0!==n.callback&&(i.callback=n.callback),r.saveState(t,e,i);this.log("[warning] setState: No LRSs added yet (state not saved)")},deleteState:function(t,e){var n,i;if(this.log("deleteState"),0<this.recordStores.length)return i=this.recordStores[0],n={agent:void 0!==(e=e||{}).agent?e.agent:this.actor,activity:void 0!==e.activity?e.activity:this.activity},void 0!==e.registration?n.registration=e.registration:null!==this.registration&&(n.registration=this.registration),void 0!==e.callback&&(n.callback=e.callback),i.dropState(t,n);this.log("[warning] deleteState: No LRSs added yet (state not deleted)")},getActivityProfile:function(t,e){var n,i;if(this.log("getActivityProfile"),0<this.recordStores.length)return i=this.recordStores[0],n={activity:void 0!==(e=e||{}).activity?e.activity:this.activity},void 0!==e.callback&&(n.callback=e.callback),i.retrieveActivityProfile(t,n);this.log("[warning] getActivityProfile: No LRSs added yet (activity profile not retrieved)")},setActivityProfile:function(t,e,n){var i,r;if(this.log("setActivityProfile"),0<this.recordStores.length)return r=this.recordStores[0],i={activity:void 0!==(n=n||{}).activity?n.activity:this.activity},void 0!==n.callback&&(i.callback=n.callback),void 0!==n.lastSHA1&&(i.lastSHA1=n.lastSHA1),void 0!==n.contentType&&(i.contentType=n.contentType,void 0!==n.overwriteJSON&&!n.overwriteJSON&&TinCan.Utils.isApplicationJSON(n.contentType)&&(i.method="POST")),r.saveActivityProfile(t,e,i);this.log("[warning] setActivityProfile: No LRSs added yet (activity profile not saved)")},deleteActivityProfile:function(t,e){var n,i;if(this.log("deleteActivityProfile"),0<this.recordStores.length)return i=this.recordStores[0],n={activity:void 0!==(e=e||{}).activity?e.activity:this.activity},void 0!==e.callback&&(n.callback=e.callback),i.dropActivityProfile(t,n);this.log("[warning] deleteActivityProfile: No LRSs added yet (activity profile not deleted)")},getAgentProfile:function(t,e){var n,i;if(this.log("getAgentProfile"),0<this.recordStores.length)return i=this.recordStores[0],n={agent:void 0!==(e=e||{}).agent?e.agent:this.actor},void 0!==e.callback&&(n.callback=e.callback),i.retrieveAgentProfile(t,n);this.log("[warning] getAgentProfile: No LRSs added yet (agent profile not retrieved)")},setAgentProfile:function(t,e,n){var i,r;if(this.log("setAgentProfile"),0<this.recordStores.length)return r=this.recordStores[0],i={agent:void 0!==(n=n||{}).agent?n.agent:this.actor},void 0!==n.callback&&(i.callback=n.callback),void 0!==n.lastSHA1&&(i.lastSHA1=n.lastSHA1),void 0!==n.contentType&&(i.contentType=n.contentType,void 0!==n.overwriteJSON&&!n.overwriteJSON&&TinCan.Utils.isApplicationJSON(n.contentType)&&(i.method="POST")),r.saveAgentProfile(t,e,i);this.log("[warning] setAgentProfile: No LRSs added yet (agent profile not saved)")},deleteAgentProfile:function(t,e){var n,i;if(this.log("deleteAgentProfile"),0<this.recordStores.length)return i=this.recordStores[0],n={agent:void 0!==(e=e||{}).agent?e.agent:this.actor},void 0!==e.callback&&(n.callback=e.callback),i.dropAgentProfile(t,n);this.log("[warning] deleteAgentProfile: No LRSs added yet (agent profile not deleted)")}},TinCan.DEBUG=!1,TinCan.enableDebug=function(){TinCan.DEBUG=!0},TinCan.disableDebug=function(){TinCan.DEBUG=!1},TinCan.versions=function(){return["1.0.2","1.0.1","1.0.0","0.95","0.9"]},"object"==typeof module&&(module.exports=TinCan)}(),function(){"use strict";TinCan.Utils={defaultEncoding:"utf8",getUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0;return("x"==t?e:3&e|8).toString(16)})},getISODateString:function(t){function e(t,e){var n,i;for(null==t&&(t=0),null==e&&(e=2),n=Math.pow(10,e-1),i=t.toString();t<n&&1<n;)i="0"+i,n/=10;return i}return t.getUTCFullYear()+"-"+e(t.getUTCMonth()+1)+"-"+e(t.getUTCDate())+"T"+e(t.getUTCHours())+":"+e(t.getUTCMinutes())+":"+e(t.getUTCSeconds())+"."+e(t.getUTCMilliseconds(),3)+"Z"},convertISO8601DurationToMilliseconds:function(t){var e,n,i,r,o=0<=t.indexOf("-"),a=t.indexOf("T"),s=t.indexOf("H"),l=t.indexOf("M"),c=t.indexOf("S");if(-1===a||-1!==l&&l<a||-1!==t.indexOf("D")||-1!==t.indexOf("Y"))throw new Error("ISO 8601 timestamps including years, months and/or days are not currently supported");return e=-1===s?(s=a,0):parseInt(t.slice(a+1,s),10),n=-1===l?(l=a,0):parseInt(t.slice(s+1,l),10),i=parseFloat(t.slice(l+1,c)),r=parseInt(1e3*(60*(60*e+n)+i),10),isNaN(r)&&(r=0),o&&(r*=-1),r},convertMillisecondsToISO8601Duration:function(t){var e,n,i,r=parseInt(t,10),o="",a="";return(i=Math.round(r/10))<0&&(o="-",i*=-1),a=o+"PT",0<(e=parseInt(i/36e4,10))&&(a+=e+"H"),0<(n=parseInt(i%36e4/6e3,10))&&(a+=n+"M"),a+=i%36e4%6e3/100+"S"},getSHA1String:function(t){return CryptoJS.SHA1(t).toString(CryptoJS.enc.Hex)},getSHA256String:function(t){return"[object ArrayBuffer]"===Object.prototype.toString.call(t)&&(t=CryptoJS.lib.WordArray.create(t)),CryptoJS.SHA256(t).toString(CryptoJS.enc.Hex)},getBase64String:function(t){return CryptoJS.enc.Base64.stringify(CryptoJS.enc.Latin1.parse(t))},getLangDictionaryValue:function(t,e){var n,i=this[t];if(void 0!==e&&void 0!==i[e])return i[e];if(void 0!==i.und)return i.und;if(void 0!==i["en-US"])return i["en-US"];for(n in i)if(i.hasOwnProperty(n))return i[n];return""},parseURL:function(t,e){function n(t){return decodeURIComponent(t.replace(c," "))}var i,r,o,a,s="/"===t.charAt(0),l=["(/[^?#]*)","(\\?[^#]*|)","(#.*|)$"],c=/\+/g,u=/([^&=]+)=?([^&]*)/g;if(e=e||{},s){if(void 0===e.allowRelative||!e.allowRelative)throw new Error("Refusing to parse relative URL without 'allowRelative' option")}else l.unshift("^(https?:)//","(([^:/?#]*)(?::([0-9]+))?)"),-1===t.indexOf("/",8)&&(t+="/");if(i=new RegExp(l.join("")),null===(r=t.match(i)))throw new Error("Unable to parse URL regular expression did not match: '"+t+"'");if(s?(o={protocol:null,host:null,hostname:null,port:null,path:null,pathname:r[1],search:r[2],hash:r[3],params:{}}).path=o.pathname:(o={protocol:r[1],host:r[2],hostname:r[3],port:r[4],pathname:r[5],search:r[6],hash:r[7],params:{}}).path=o.protocol+"//"+o.host+o.pathname,""!==o.search)for(;a=u.exec(o.search.substring(1));)o.params[n(a[1])]=n(a[2]);return o},getServerRoot:function(t){var e=t.split("/");return e[0]+"//"+e[2]},getContentTypeFromHeader:function(t){return String(t).split(";")[0]},isApplicationJSON:function(t){return 0===TinCan.Utils.getContentTypeFromHeader(t).toLowerCase().indexOf("application/json")},stringToArrayBuffer:function(){TinCan.prototype.log("stringToArrayBuffer not overloaded - no environment loaded?")},stringFromArrayBuffer:function(){TinCan.prototype.log("stringFromArrayBuffer not overloaded - no environment loaded?")}}}(),function(){"use strict";var t=TinCan.LRS=function(t){this.log("constructor"),this.endpoint=null,this.version=null,this.auth=null,this.allowFail=!0,this.extended=null,this.init(t)};t.prototype={LOG_SRC:"LRS",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=TinCan.versions(),i=!1;if((t=t||{}).hasOwnProperty("alertOnRequestFailure")&&this.log("'alertOnRequestFailure' is deprecated (alerts have been removed) no need to set it now"),!t.hasOwnProperty("endpoint")||null===t.endpoint||""===t.endpoint)throw this.log("[error] LRS invalid: no endpoint"),{code:3,mesg:"LRS invalid: no endpoint"};if(this.endpoint=String(t.endpoint),"/"!==this.endpoint.slice(-1)&&(this.log("adding trailing slash to endpoint"),this.endpoint+="/"),t.hasOwnProperty("allowFail")&&(this.allowFail=t.allowFail),t.hasOwnProperty("auth")?this.auth=t.auth:t.hasOwnProperty("username")&&t.hasOwnProperty("password")&&(this.auth="Basic "+TinCan.Utils.getBase64String(t.username+":"+t.password)),t.hasOwnProperty("extended")&&(this.extended=t.extended),this._initByEnvironment(t),void 0!==t.version){for(this.log("version: "+t.version),e=0;e<n.length;e+=1)if(n[e]===t.version){i=!0;break}if(!i)throw this.log("[error] LRS invalid: version not supported ("+t.version+")"),{code:5,mesg:"LRS invalid: version not supported ("+t.version+")"};this.version=t.version}else this.version=n[0]},_getBoundary:function(){return TinCan.Utils.getUUID().replace(/-/g,"")},_initByEnvironment:function(){this.log("_initByEnvironment not overloaded - no environment loaded?")},_makeRequest:function(){this.log("_makeRequest not overloaded - no environment loaded?")},_getMultipartRequestData:function(){this.log("_getMultipartRequestData not overloaded - no environment loaded?")},_IEModeConversion:function(){this.log("_IEModeConversion not overloaded - browser environment not loaded.")},_processGetStatementResult:function(t,e){var n,i,r,o,a={};if(!e.attachments)return TinCan.Statement.fromJSON(t.responseText);for(n=t.getResponseHeader("Content-Type").split("boundary=")[1],i=this._parseMultipart(n,t.response),r=JSON.parse(i[0].body),o=1;o<i.length;o+=1)a[i[o].headers["X-Experience-API-Hash"]]=i[o].body;return this._assignAttachmentContent([r],a),new TinCan.Statement(r)},sendRequest:function(t){this.log("sendRequest");var e,n=this.endpoint+t.url,i={};if(0===t.url.indexOf("http")&&(n=t.url),null!==this.extended)for(e in t.params=t.params||{},this.extended)this.extended.hasOwnProperty(e)&&(t.params.hasOwnProperty(e)||null!==this.extended[e]&&(t.params[e]=this.extended[e]));for(e in i.Authorization=this.auth,"0.9"!==this.version&&(i["X-Experience-API-Version"]=this.version),t.headers)t.headers.hasOwnProperty(e)&&(i[e]=t.headers[e]);return this._makeRequest(n,i,t)},about:function(i){var t,e,n;if(this.log("about"),t={url:"about",method:"GET",params:{}},void 0!==(i=i||{}).callback&&(n=function(t,e){var n=e;null===t&&(n=TinCan.About.fromJSON(e.responseText)),i.callback(t,n)},t.callback=n),e=this.sendRequest(t),!n)return null===e.err&&(e.xhr=TinCan.About.fromJSON(e.xhr.responseText)),e},saveStatement:function(t,e){this.log("saveStatement");var n,i,r,o={url:"statements",headers:{}},a=[];e=e||{};try{n=t.asVersion(this.version)}catch(t){return this.allowFail?(this.log("[warning] statement could not be serialized in version ("+this.version+"): "+t),void 0!==e.callback?void e.callback(null,null):{err:null,xhr:null}):(this.log("[error] statement could not be serialized in version ("+this.version+"): "+t),void 0!==e.callback?void e.callback(t,null):{err:t,xhr:null})}if(n.hasOwnProperty("attachments")&&t.hasAttachmentWithContent()){for(i=this._getBoundary(),o.headers["Content-Type"]="multipart/mixed; boundary="+i,r=0;r<t.attachments.length;r+=1)null!==t.attachments[r].content&&a.push(t.attachments[r]);try{o.data=this._getMultipartRequestData(i,n,a)}catch(t){return this.allowFail?(this.log("[warning] multipart request data could not be created (attachments probably not supported): "+t),void 0!==e.callback?void e.callback(null,null):{err:null,xhr:null}):(this.log("[error] multipart request data could not be created (attachments probably not supported): "+t),void 0!==e.callback?void e.callback(t,null):{err:t,xhr:null})}}else o.headers["Content-Type"]="application/json",o.data=JSON.stringify(n);return null!==t.id?(o.method="PUT",o.params={statementId:t.id}):o.method="POST",void 0!==e.callback&&(o.callback=e.callback),this.sendRequest(o)},retrieveStatement:function(t,i){this.log("retrieveStatement");var e,n,r,o=this;return(i=i||{}).params=i.params||{},e={url:"statements",method:"GET",params:{statementId:t}},i.params.attachments&&(e.params.attachments=!0,e.expectMultipart=!0),void 0!==i.callback&&(r=function(t,e){var n=e;null===t&&(n=o._processGetStatementResult(e,i.params)),i.callback(t,n)},e.callback=r),n=this.sendRequest(e),r||(n.statement=null)===n.err&&(n.statement=o._processGetStatementResult(n.xhr,i.params)),n},retrieveVoidedStatement:function(t,i){this.log("retrieveVoidedStatement");var e,n,r,o=this;return(i=i||{}).params=i.params||{},e={url:"statements",method:"GET",params:{}},"0.9"===this.version||"0.95"===this.version?e.params.statementId=t:(e.params.voidedStatementId=t,i.params.attachments&&(e.params.attachments=!0,e.expectMultipart=!0)),void 0!==i.callback&&(r=function(t,e){var n=e;null===t&&(n=o._processGetStatementResult(e,i.params)),i.callback(t,n)},e.callback=r),n=this.sendRequest(e),r||(n.statement=null)===n.err&&(n.statement=o._processGetStatementResult(n.xhr,i.params)),n},saveStatements:function(t,e){this.log("saveStatements");var n,i,r,o,a={url:"statements",method:"POST",headers:{}},s=[],l=[];if(e=e||{},0===t.length)return void 0!==e.callback?void e.callback(new Error("no statements"),null):{err:new Error("no statements"),xhr:null};for(r=0;r<t.length;r+=1){try{n=t[r].asVersion(this.version)}catch(t){return this.allowFail?(this.log("[warning] statement could not be serialized in version ("+this.version+"): "+t),void 0!==e.callback?void e.callback(null,null):{err:null,xhr:null}):(this.log("[error] statement could not be serialized in version ("+this.version+"): "+t),void 0!==e.callback?void e.callback(t,null):{err:t,xhr:null})}if(t[r].hasAttachmentWithContent())for(o=0;o<t[r].attachments.length;o+=1)null!==t[r].attachments[o].content&&l.push(t[r].attachments[o]);s.push(n)}if(0!==l.length){i=this._getBoundary(),a.headers["Content-Type"]="multipart/mixed; boundary="+i;try{a.data=this._getMultipartRequestData(i,s,l)}catch(t){return this.allowFail?(this.log("[warning] multipart request data could not be created (attachments probably not supported): "+t),void 0!==e.callback?void e.callback(null,null):{err:null,xhr:null}):(this.log("[error] multipart request data could not be created (attachments probably not supported): "+t),void 0!==e.callback?void e.callback(t,null):{err:t,xhr:null})}}else a.headers["Content-Type"]="application/json",a.data=JSON.stringify(s);return void 0!==e.callback&&(a.callback=e.callback),this.sendRequest(a)},queryStatements:function(l){this.log("queryStatements");var t,e,n,c=this;(l=l||{}).params=l.params||{};try{t=this._queryStatementsRequestCfg(l),l.params.attachments&&(t.expectMultipart=!0)}catch(t){return this.log("[error] Query statements failed - "+t),void 0!==l.callback&&l.callback(t,{}),{err:t,statementsResult:null}}return void 0!==l.callback&&(n=function(t,e){var n,i,r,o,a=e,s={};if(null===t)if(l.params.attachments){for(i=e.getResponseHeader("Content-Type").split("boundary=")[1],n=c._parseMultipart(i,e.response),r=JSON.parse(n[0].body),o=1;o<n.length;o+=1)s[n[o].headers["X-Experience-API-Hash"]]=n[o].body;for(c._assignAttachmentContent(r.statements,s),a=new TinCan.StatementsResult({statements:r.statements}),o=0;o<a.statements.length;o+=1)a.statements[o]instanceof TinCan.Statement||(a.statements[o]=new TinCan.Statement(a.statements[o]))}else a=TinCan.StatementsResult.fromJSON(e.responseText);l.callback(t,a)},t.callback=n),(e=this.sendRequest(t)).config=t,n||(e.statementsResult=null)===e.err&&(e.statementsResult=TinCan.StatementsResult.fromJSON(e.xhr.responseText)),e},_queryStatementsRequestCfg:function(t){this.log("_queryStatementsRequestCfg");var e,n,i={},r={url:"statements",method:"GET",params:i},o=["agent","actor","object","instructor"],a=["verb","activity"],s=["registration","context","since","until","limit","authoritative","sparse","ascending","related_activities","related_agents","format","attachments"],l={verb:!0,registration:!0,since:!0,until:!0,limit:!0,ascending:!0},c={.9:{supported:{actor:!0,instructor:!0,target:!0,object:!0,context:!0,authoritative:!0,sparse:!0}},"1.0.0":{supported:{agent:!0,activity:!0,related_activities:!0,related_agents:!0,format:!0,attachments:!0}}};for(n in c[.95]=c[.9],c["1.0.1"]=c["1.0.0"],c["1.0.2"]=c["1.0.0"],t.params.hasOwnProperty("target")&&(t.params.object=t.params.target),t.params)if(t.params.hasOwnProperty(n)&&void 0===l[n]&&void 0===c[this.version].supported[n])throw"Unrecognized query parameter configured: "+n;for(e=0;e<o.length;e+=1)void 0!==t.params[o[e]]&&(i[o[e]]=JSON.stringify(t.params[o[e]].asVersion(this.version)));for(e=0;e<a.length;e+=1)void 0!==t.params[a[e]]&&(void 0===t.params[a[e]].id?i[a[e]]=t.params[a[e]]:i[a[e]]=t.params[a[e]].id);for(e=0;e<s.length;e+=1)void 0!==t.params[s[e]]&&null!==t.params[s[e]]&&(i[s[e]]=t.params[s[e]]);return r},_assignAttachmentContent:function(t,e){var n,i;for(n=0;n<t.length;n+=1)if(t[n].hasOwnProperty("attachments")&&null!==t[n].attachments)for(i=0;i<t[n].attachments.length;i+=1)e.hasOwnProperty(t[n].attachments[i].sha2)&&(t[n].attachments[i].content=e[t[n].attachments[i].sha2])},_parseMultipart:function(t,e){var n,i,r,o,a,s,l,c,u,h,p,f="--"+t,d=[];for(n=new Uint8Array(e),r=(i=this.__uint8ToString(n)).indexOf(f+"--"),o=i.indexOf(f);-1!==o;)a=i.indexOf(f,o+f.length),s=o+f.length+2,c=(l=i.indexOf("\r\n\r\n",o))+2+2,u=a-2,h=this._parseHeaders(this.__uint8ToString(new Uint8Array(e.slice(s,l)))),p=e.slice(c,u),0===d.length&&(p=TinCan.Utils.stringFromArrayBuffer(p)),d.push({headers:h,body:p}),o=a===r?-1:a;return d},__uint8ToString:function(t){var e,n="",i=t.byteLength;for(e=0;e<i;e+=1)n+=String.fromCharCode(t[e]);return n},_parseHeaders:function(t){var e,n,i,r={};for(e=t.split("\n"),i=0;i<e.length;i+=1)null!==(n=e[i].split(":",2))[1]?(r[n[0]]=n[1].replace(/^\s+|\s+$/g,""),n[0]):"\t"===n[0].substring(0,1)&&(r[n[0]]=n[1].replace(/^\s+|\s+$/g,""));return r},moreStatements:function(i){var t,e,n,r,o;return this.log("moreStatements: "+i.url),i=i||{},r=TinCan.Utils.parseURL(i.url,{allowRelative:!0}),o=TinCan.Utils.getServerRoot(this.endpoint),0===r.path.indexOf("/statements")&&(r.path=this.endpoint.replace(o,"")+r.path,this.log("converting non-standard more URL to "+r.path)),0!==r.path.indexOf("/")&&(r.path="/"+r.path),t={method:"GET",url:o+r.path,params:r.params},void 0!==i.callback&&(n=function(t,e){var n=e;null===t&&(n=TinCan.StatementsResult.fromJSON(e.responseText)),i.callback(t,n)},t.callback=n),(e=this.sendRequest(t)).config=t,n||(e.statementsResult=null)===e.err&&(e.statementsResult=TinCan.StatementsResult.fromJSON(e.xhr.responseText)),e},retrieveState:function(i,r){this.log("retrieveState");var t,e,n,o={},a={},s=this;if(n=r.requestHeaders||{},o={stateId:i,activityId:r.activity.id},"0.9"===this.version?o.actor=JSON.stringify(r.agent.asVersion(this.version)):o.agent=JSON.stringify(r.agent.asVersion(this.version)),void 0!==r.registration&&null!==r.registration&&("0.9"===this.version?o.registrationId=r.registration:o.registration=r.registration),a={url:"activities/state",method:"GET",params:o,ignore404:!0,headers:n},void 0!==r.callback&&(e=function(t,e){var n=e;if(null===t)if(404===e.status)n=null;else if(n=new TinCan.State({id:i,contents:e.responseText}),void 0!==e.getResponseHeader&&null!==e.getResponseHeader("ETag")&&""!==e.getResponseHeader("ETag")?n.etag=e.getResponseHeader("ETag"):n.etag='"'+TinCan.Utils.getSHA1String(e.responseText)+'"',void 0!==e.contentType?n.contentType=e.contentType:void 0!==e.getResponseHeader&&null!==e.getResponseHeader("Content-Type")&&""!==e.getResponseHeader("Content-Type")&&(n.contentType=e.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(n.contentType))try{n.contents=JSON.parse(n.contents)}catch(t){s.log("retrieveState - failed to deserialize JSON: "+t)}r.callback(t,n)},a.callback=e),t=this.sendRequest(a),!e&&(t.state=null)===t.err&&404!==t.xhr.status&&(t.state=new TinCan.State({id:i,contents:t.xhr.responseText}),void 0!==t.xhr.getResponseHeader&&null!==t.xhr.getResponseHeader("ETag")&&""!==t.xhr.getResponseHeader("ETag")?t.state.etag=t.xhr.getResponseHeader("ETag"):t.state.etag='"'+TinCan.Utils.getSHA1String(t.xhr.responseText)+'"',void 0!==t.xhr.contentType?t.state.contentType=t.xhr.contentType:void 0!==t.xhr.getResponseHeader&&null!==t.xhr.getResponseHeader("Content-Type")&&""!==t.xhr.getResponseHeader("Content-Type")&&(t.state.contentType=t.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(t.state.contentType)))try{t.state.contents=JSON.parse(t.state.contents)}catch(t){this.log("retrieveState - failed to deserialize JSON: "+t)}return t},retrieveStateIds:function(i){this.log("retrieveStateIds");var t,e,n,r,o={};if(e=(i=i||{}).requestHeaders||{},o.activityId=i.activity.id,"0.9"===this.version?o.actor=JSON.stringify(i.agent.asVersion(this.version)):o.agent=JSON.stringify(i.agent.asVersion(this.version)),void 0!==i.registration&&null!==i.registration&&("0.9"===this.version?o.registrationId=i.registration:o.registration=i.registration),t={url:"activities/state",method:"GET",params:o,headers:e,ignore404:!0},void 0!==i.callback&&(r=function(e,t){var n=t;if(null===e){if(404===t.status)n=[];else try{n=JSON.parse(t.responseText)}catch(t){e="Response JSON parse error: "+t}i.callback(e,n)}else i.callback(e,n)},t.callback=r),void 0!==i.since&&(t.params.since=i.since),n=this.sendRequest(t),!r){if((n.profileIds=null)!==n.err)return n;if(404===n.xhr.status)n.profileIds=[];else try{n.profileIds=JSON.parse(n.xhr.responseText)}catch(t){n.err="retrieveStateIds - JSON parse error: "+t}}return n},saveState:function(t,e,n){var i,r,o;return this.log("saveState"),o=n.requestHeaders||{},void 0===n.contentType&&(n.contentType="application/octet-stream"),o["Content-Type"]=n.contentType,"object"==typeof e&&TinCan.Utils.isApplicationJSON(n.contentType)&&(e=JSON.stringify(e)),void 0!==n.method&&"POST"===n.method||(n.method="PUT"),i={stateId:t,activityId:n.activity.id},"0.9"===this.version?i.actor=JSON.stringify(n.agent.asVersion(this.version)):i.agent=JSON.stringify(n.agent.asVersion(this.version)),void 0!==n.registration&&null!==n.registration&&("0.9"===this.version?i.registrationId=n.registration:i.registration=n.registration),r={url:"activities/state",method:n.method,params:i,data:e,headers:o},void 0!==n.callback&&(r.callback=n.callback),void 0!==n.lastSHA1&&null!==n.lastSHA1&&(r.headers["If-Match"]=n.lastSHA1),this.sendRequest(r)},dropState:function(t,e){var n,i,r;return this.log("dropState"),r=e.requestHeaders||{},n={activityId:e.activity.id},"0.9"===this.version?n.actor=JSON.stringify(e.agent.asVersion(this.version)):n.agent=JSON.stringify(e.agent.asVersion(this.version)),null!==t&&(n.stateId=t),void 0!==e.registration&&null!==e.registration&&("0.9"===this.version?n.registrationId=e.registration:n.registration=e.registration),i={url:"activities/state",method:"DELETE",params:n,headers:r},void 0!==e.callback&&(i.callback=e.callback),this.sendRequest(i)},retrieveActivity:function(i,r){this.log("retrieveActivity");var t,e,n,o={};return n=r.requestHeaders||{},o={url:"activities",method:"GET",params:{activityId:i},ignore404:!0,headers:n},void 0!==r.callback&&(e=function(t,e){var n=e;null===t&&(n=404===e.status?new TinCan.Activity({id:i}):TinCan.Activity.fromJSON(e.responseText)),r.callback(t,n)},o.callback=e),t=this.sendRequest(o),e||(t.activity=null)===t.err&&(404===t.xhr.status?t.activity=new TinCan.Activity({id:i}):t.activity=TinCan.Activity.fromJSON(t.xhr.responseText)),t},retrieveActivityProfile:function(i,r){this.log("retrieveActivityProfile");var t,e,n,o={},a=this;if(n=r.requestHeaders||{},o={url:"activities/profile",method:"GET",params:{profileId:i,activityId:r.activity.id},ignore404:!0,headers:n},void 0!==r.callback&&(e=function(t,e){var n=e;if(null===t)if(404===e.status)n=null;else if(n=new TinCan.ActivityProfile({id:i,activity:r.activity,contents:e.responseText}),void 0!==e.getResponseHeader&&null!==e.getResponseHeader("ETag")&&""!==e.getResponseHeader("ETag")?n.etag=e.getResponseHeader("ETag"):n.etag='"'+TinCan.Utils.getSHA1String(e.responseText)+'"',void 0!==e.contentType?n.contentType=e.contentType:void 0!==e.getResponseHeader&&null!==e.getResponseHeader("Content-Type")&&""!==e.getResponseHeader("Content-Type")&&(n.contentType=e.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(n.contentType))try{n.contents=JSON.parse(n.contents)}catch(t){a.log("retrieveActivityProfile - failed to deserialize JSON: "+t)}r.callback(t,n)},o.callback=e),t=this.sendRequest(o),!e&&(t.profile=null)===t.err&&404!==t.xhr.status&&(t.profile=new TinCan.ActivityProfile({id:i,activity:r.activity,contents:t.xhr.responseText}),void 0!==t.xhr.getResponseHeader&&null!==t.xhr.getResponseHeader("ETag")&&""!==t.xhr.getResponseHeader("ETag")?t.profile.etag=t.xhr.getResponseHeader("ETag"):t.profile.etag='"'+TinCan.Utils.getSHA1String(t.xhr.responseText)+'"',void 0!==t.xhr.contentType?t.profile.contentType=t.xhr.contentType:void 0!==t.xhr.getResponseHeader&&null!==t.xhr.getResponseHeader("Content-Type")&&""!==t.xhr.getResponseHeader("Content-Type")&&(t.profile.contentType=t.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(t.profile.contentType)))try{t.profile.contents=JSON.parse(t.profile.contents)}catch(t){this.log("retrieveActivityProfile - failed to deserialize JSON: "+t)}return t},retrieveActivityProfileIds:function(i){var t,e,n,r;if(this.log("retrieveActivityProfileIds"),e=(i=i||{}).requestHeaders||{},t={url:"activities/profile",method:"GET",params:{activityId:i.activity.id},headers:e,ignore404:!0},void 0!==i.callback&&(r=function(e,t){var n=t;if(null===e){if(404===t.status)n=[];else try{n=JSON.parse(t.responseText)}catch(t){e="Response JSON parse error: "+t}i.callback(e,n)}else i.callback(e,n)},t.callback=r),void 0!==i.since&&(t.params.since=i.since),n=this.sendRequest(t),!r){if((n.profileIds=null)!==n.err)return n;if(404===n.xhr.status)n.profileIds=[];else try{n.profileIds=JSON.parse(n.xhr.responseText)}catch(t){n.err="retrieveActivityProfileIds - JSON parse error: "+t}}return n},saveActivityProfile:function(t,e,n){var i,r;return this.log("saveActivityProfile"),r=n.requestHeaders||{},void 0===n.contentType&&(n.contentType="application/octet-stream"),r["Content-Type"]=n.contentType,void 0!==n.method&&"POST"===n.method||(n.method="PUT"),"object"==typeof e&&TinCan.Utils.isApplicationJSON(n.contentType)&&(e=JSON.stringify(e)),i={url:"activities/profile",method:n.method,params:{profileId:t,activityId:n.activity.id},data:e,headers:r},void 0!==n.callback&&(i.callback=n.callback),void 0!==n.lastSHA1&&null!==n.lastSHA1?i.headers["If-Match"]=n.lastSHA1:i.headers["If-None-Match"]="*",this.sendRequest(i)},dropActivityProfile:function(t,e){var n,i;return this.log("dropActivityProfile"),i=e.requestHeaders||{},n={url:"activities/profile",method:"DELETE",params:{profileId:t,activityId:e.activity.id},headers:i},void 0!==e.callback&&(n.callback=e.callback),this.sendRequest(n)},retrieveAgentProfile:function(i,r){this.log("retrieveAgentProfile");var t,e,n,o={},a=this;if(n=r.requestHeaders||{},o={method:"GET",params:{profileId:i},ignore404:!0,headers:n},"0.9"===this.version?(o.url="actors/profile",o.params.actor=JSON.stringify(r.agent.asVersion(this.version))):(o.url="agents/profile",o.params.agent=JSON.stringify(r.agent.asVersion(this.version))),void 0!==r.callback&&(e=function(t,e){var n=e;if(null===t)if(404===e.status)n=null;else if(n=new TinCan.AgentProfile({id:i,agent:r.agent,contents:e.responseText}),void 0!==e.getResponseHeader&&null!==e.getResponseHeader("ETag")&&""!==e.getResponseHeader("ETag")?n.etag=e.getResponseHeader("ETag"):n.etag='"'+TinCan.Utils.getSHA1String(e.responseText)+'"',void 0!==e.contentType?n.contentType=e.contentType:void 0!==e.getResponseHeader&&null!==e.getResponseHeader("Content-Type")&&""!==e.getResponseHeader("Content-Type")&&(n.contentType=e.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(n.contentType))try{n.contents=JSON.parse(n.contents)}catch(t){a.log("retrieveAgentProfile - failed to deserialize JSON: "+t)}r.callback(t,n)},o.callback=e),t=this.sendRequest(o),!e&&(t.profile=null)===t.err&&404!==t.xhr.status&&(t.profile=new TinCan.AgentProfile({id:i,agent:r.agent,contents:t.xhr.responseText}),void 0!==t.xhr.getResponseHeader&&null!==t.xhr.getResponseHeader("ETag")&&""!==t.xhr.getResponseHeader("ETag")?t.profile.etag=t.xhr.getResponseHeader("ETag"):t.profile.etag='"'+TinCan.Utils.getSHA1String(t.xhr.responseText)+'"',void 0!==t.xhr.contentType?t.profile.contentType=t.xhr.contentType:void 0!==t.xhr.getResponseHeader&&null!==t.xhr.getResponseHeader("Content-Type")&&""!==t.xhr.getResponseHeader("Content-Type")&&(t.profile.contentType=t.xhr.getResponseHeader("Content-Type")),TinCan.Utils.isApplicationJSON(t.profile.contentType)))try{t.profile.contents=JSON.parse(t.profile.contents)}catch(t){this.log("retrieveAgentProfile - failed to deserialize JSON: "+t)}return t},retrieveAgentProfileIds:function(i){this.log("retrieveAgentProfileIds");var t,e,n,r={};if(t={method:"GET",params:r,headers:(i=i||{}).requestHeaders||{},ignore404:!0},"0.9"===this.version?(t.url="actors/profile",r.actor=JSON.stringify(i.agent.asVersion(this.version))):(t.url="agents/profile",r.agent=JSON.stringify(i.agent.asVersion(this.version))),void 0!==i.callback&&(n=function(e,t){var n=t;if(null===e){if(404===t.status)n=[];else try{n=JSON.parse(t.responseText)}catch(t){e="Response JSON parse error: "+t}i.callback(e,n)}else i.callback(e,n)},t.callback=n),void 0!==i.since&&(t.params.since=i.since),e=this.sendRequest(t),!n){if((e.profileIds=null)!==e.err)return e;if(404===e.xhr.status)e.profileIds=[];else try{e.profileIds=JSON.parse(e.xhr.responseText)}catch(t){e.err="retrieveAgentProfileIds - JSON parse error: "+t}}return e},saveAgentProfile:function(t,e,n){var i,r;return this.log("saveAgentProfile"),r=n.requestHeaders||{},void 0===n.contentType&&(n.contentType="application/octet-stream"),r["Content-Type"]=n.contentType,void 0!==n.method&&"POST"===n.method||(n.method="PUT"),"object"==typeof e&&TinCan.Utils.isApplicationJSON(n.contentType)&&(e=JSON.stringify(e)),i={method:n.method,params:{profileId:t},data:e,headers:r},"0.9"===this.version?(i.url="actors/profile",i.params.actor=JSON.stringify(n.agent.asVersion(this.version))):(i.url="agents/profile",i.params.agent=JSON.stringify(n.agent.asVersion(this.version))),void 0!==n.callback&&(i.callback=n.callback),void 0!==n.lastSHA1&&null!==n.lastSHA1?i.headers["If-Match"]=n.lastSHA1:i.headers["If-None-Match"]="*",this.sendRequest(i)},dropAgentProfile:function(t,e){var n,i;return this.log("dropAgentProfile"),i={method:"DELETE",params:n={profileId:t},headers:e.requestHeaders||{}},"0.9"===this.version?(i.url="actors/profile",n.actor=JSON.stringify(e.agent.asVersion(this.version))):(i.url="agents/profile",n.agent=JSON.stringify(e.agent.asVersion(this.version))),void 0!==e.callback&&(i.callback=e.callback),this.sendRequest(i)}},t.syncEnabled=null}(),function(){"use strict";var n=TinCan.AgentAccount=function(t){this.log("constructor"),this.homePage=null,this.name=null,this.init(t)};n.prototype={LOG_SRC:"AgentAccount",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["name","homePage"];for(void 0!==(t=t||{}).accountServiceHomePage&&(t.homePage=t.accountServiceHomePage),void 0!==t.accountName&&(t.name=t.accountName),e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])},toString:function(){this.log("toString");var t="";return null!==this.name||null!==this.homePage?(t+=null!==this.name?this.name:"-",t+=":",t+=null!==this.homePage?this.homePage:"-"):t="AgentAccount: unidentified",t},asVersion:function(t){this.log("asVersion: "+t);var e={};return"0.9"===(t=t||TinCan.versions()[0])?(e.accountName=this.name,e.accountServiceHomePage=this.homePage):(e.name=this.name,e.homePage=this.homePage),e}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Agent=function(t){this.log("constructor"),this.name=null,this.mbox=null,this.mbox_sha1sum=null,this.openid=null,this.account=null,this.degraded=!1,this.init(t)};n.prototype={objectType:"Agent",LOG_SRC:"Agent",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n,i=["name","mbox","mbox_sha1sum","openid"];for(void 0!==(t=t||{}).lastName||void 0!==t.firstName?(t.name="",void 0!==t.firstName&&0<t.firstName.length&&(t.name=t.firstName[0],1<t.firstName.length&&(this.degraded=!0)),""!==t.name&&(t.name+=" "),void 0!==t.lastName&&0<t.lastName.length&&(t.name+=t.lastName[0],1<t.lastName.length&&(this.degraded=!0))):void 0===t.familyName&&void 0===t.givenName||(t.name="",void 0!==t.givenName&&0<t.givenName.length&&(t.name=t.givenName[0],1<t.givenName.length&&(this.degraded=!0)),""!==t.name&&(t.name+=" "),void 0!==t.familyName&&0<t.familyName.length&&(t.name+=t.familyName[0],1<t.familyName.length&&(this.degraded=!0))),"object"==typeof t.name&&null!==t.name&&(1<t.name.length&&(this.degraded=!0),t.name=t.name[0]),"object"==typeof t.mbox&&null!==t.mbox&&(1<t.mbox.length&&(this.degraded=!0),t.mbox=t.mbox[0]),"object"==typeof t.mbox_sha1sum&&null!==t.mbox_sha1sum&&(1<t.mbox_sha1sum.length&&(this.degraded=!0),t.mbox_sha1sum=t.mbox_sha1sum[0]),"object"==typeof t.openid&&null!==t.openid&&(1<t.openid.length&&(this.degraded=!0),t.openid=t.openid[0]),"object"==typeof t.account&&null!==t.account&&void 0===t.account.homePage&&void 0===t.account.name&&(0===t.account.length?delete t.account:(1<t.account.length&&(this.degraded=!0),t.account=t.account[0])),t.hasOwnProperty("account")&&(t.account instanceof TinCan.AgentAccount?this.account=t.account:this.account=new TinCan.AgentAccount(t.account)),e=0;e<i.length;e+=1)t.hasOwnProperty(i[e])&&null!==t[i[e]]&&(n=t[i[e]],"mbox"===i[e]&&-1===n.indexOf("mailto:")&&(n="mailto:"+n),this[i[e]]=n)},toString:function(){return this.log("toString"),null!==this.name?this.name:null!==this.mbox?this.mbox.replace("mailto:",""):null!==this.mbox_sha1sum?this.mbox_sha1sum:null!==this.openid?this.openid:null!==this.account?this.account.toString():this.objectType+": unidentified"},asVersion:function(t){this.log("asVersion: "+t);var e={objectType:this.objectType};return"0.9"===(t=t||TinCan.versions()[0])?(null!==this.mbox?e.mbox=[this.mbox]:null!==this.mbox_sha1sum?e.mbox_sha1sum=[this.mbox_sha1sum]:null!==this.openid?e.openid=[this.openid]:null!==this.account&&(e.account=[this.account.asVersion(t)]),null!==this.name&&(e.name=[this.name])):(null!==this.mbox?e.mbox=this.mbox:null!==this.mbox_sha1sum?e.mbox_sha1sum=this.mbox_sha1sum:null!==this.openid?e.openid=this.openid:null!==this.account&&(e.account=this.account.asVersion(t)),null!==this.name&&(e.name=this.name)),e}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Group=function(t){this.log("constructor"),this.name=null,this.mbox=null,this.mbox_sha1sum=null,this.openid=null,this.account=null,this.member=[],this.init(t)};n.prototype={objectType:"Group",LOG_SRC:"Group",log:TinCan.prototype.log,init:function(t){var e;if(this.log("init"),t=t||{},TinCan.Agent.prototype.init.call(this,t),void 0!==t.member)for(e=0;e<t.member.length;e+=1)t.member[e]instanceof TinCan.Agent?this.member.push(t.member[e]):this.member.push(new TinCan.Agent(t.member[e]))},toString:function(t){this.log("toString");var e=TinCan.Agent.prototype.toString.call(this,t);return e!==this.objectType+": unidentified"&&(e=this.objectType+": "+e),e},asVersion:function(t){var e,n;if(this.log("asVersion: "+t),t=t||TinCan.versions()[0],e=TinCan.Agent.prototype.asVersion.call(this,t),0<this.member.length)for(e.member=[],n=0;n<this.member.length;n+=1)e.member.push(this.member[n].asVersion(t));return e}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var r={"http://adlnet.gov/expapi/verbs/experienced":"experienced","http://adlnet.gov/expapi/verbs/attended":"attended","http://adlnet.gov/expapi/verbs/attempted":"attempted","http://adlnet.gov/expapi/verbs/completed":"completed","http://adlnet.gov/expapi/verbs/passed":"passed","http://adlnet.gov/expapi/verbs/failed":"failed","http://adlnet.gov/expapi/verbs/answered":"answered","http://adlnet.gov/expapi/verbs/interacted":"interacted","http://adlnet.gov/expapi/verbs/imported":"imported","http://adlnet.gov/expapi/verbs/created":"created","http://adlnet.gov/expapi/verbs/shared":"shared","http://adlnet.gov/expapi/verbs/voided":"voided"},n=TinCan.Verb=function(t){this.log("constructor"),this.id=null,this.display=null,this.init(t)};n.prototype={LOG_SRC:"Verb",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n,i=["id","display"];if("string"==typeof t){for(n in this.id=t,this.display={und:this.id},r)if(r.hasOwnProperty(n)&&r[n]===t){this.id=n;break}}else{for(t=t||{},e=0;e<i.length;e+=1)t.hasOwnProperty(i[e])&&null!==t[i[e]]&&(this[i[e]]=t[i[e]]);null===this.display&&void 0!==r[this.id]&&(this.display={und:r[this.id]})}},toString:function(t){return this.log("toString"),null!==this.display?this.getLangDictionaryValue("display",t):this.id},asVersion:function(t){var e;return this.log("asVersion"),"0.9"===(t=t||TinCan.versions()[0])?e=r[this.id]:(e={id:this.id},null!==this.display&&(e.display=this.display)),e},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Result=function(t){this.log("constructor"),this.score=null,this.success=null,this.completion=null,this.duration=null,this.response=null,this.extensions=null,this.init(t)};n.prototype={LOG_SRC:"Result",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["completion","duration","extensions","response","success"];for((t=t||{}).hasOwnProperty("score")&&null!==t.score&&(t.score instanceof TinCan.Score?this.score=t.score:this.score=new TinCan.Score(t.score)),e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]]);"Completed"===this.completion&&(this.completion=!0)},asVersion:function(t){this.log("asVersion");var e,n={},i=["success","duration","response","extensions"],r=["score"];for(t=t||TinCan.versions()[0],e=0;e<i.length;e+=1)null!==this[i[e]]&&(n[i[e]]=this[i[e]]);for(e=0;e<r.length;e+=1)null!==this[r[e]]&&(n[r[e]]=this[r[e]].asVersion(t));return null!==this.completion&&("0.9"===t?this.completion&&(n.completion="Completed"):n.completion=this.completion),n}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Score=function(t){this.log("constructor"),this.scaled=null,this.raw=null,this.min=null,this.max=null,this.init(t)};n.prototype={LOG_SRC:"Score",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["scaled","raw","min","max"];for(t=t||{},e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])},asVersion:function(t){this.log("asVersion");var e,n={},i=["scaled","raw","min","max"];for(t=t||TinCan.versions()[0],e=0;e<i.length;e+=1)null!==this[i[e]]&&(n[i[e]]=this[i[e]]);return n}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.InteractionComponent=function(t){this.log("constructor"),this.id=null,this.description=null,this.init(t)};n.prototype={LOG_SRC:"InteractionComponent",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["id","description"];for(t=t||{},e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])},asVersion:function(t){this.log("asVersion");var e,n,i={id:this.id},r=["description"];for(t=t||TinCan.versions()[0],e=0;e<r.length;e+=1)null!==this[n=r[e]]&&(i[n]=this[n]);return i},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var s={"http://adlnet.gov/expapi/activities/course":"course","http://adlnet.gov/expapi/activities/module":"module","http://adlnet.gov/expapi/activities/meeting":"meeting","http://adlnet.gov/expapi/activities/media":"media","http://adlnet.gov/expapi/activities/performance":"performance","http://adlnet.gov/expapi/activities/simulation":"simulation","http://adlnet.gov/expapi/activities/assessment":"assessment","http://adlnet.gov/expapi/activities/interaction":"interaction","http://adlnet.gov/expapi/activities/cmi.interaction":"cmi.interaction","http://adlnet.gov/expapi/activities/question":"question","http://adlnet.gov/expapi/activities/objective":"objective","http://adlnet.gov/expapi/activities/link":"link"},n=TinCan.ActivityDefinition=function(t){this.log("constructor"),this.name=null,this.description=null,this.type=null,this.moreInfo=null,this.extensions=null,this.interactionType=null,this.correctResponsesPattern=null,this.choices=null,this.scale=null,this.source=null,this.target=null,this.steps=null,this.init(t)};n.prototype={LOG_SRC:"ActivityDefinition",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n,i,r=["name","description","moreInfo","extensions","correctResponsesPattern"],o=[];if((t=t||{}).hasOwnProperty("type")&&null!==t.type){for(i in s)s.hasOwnProperty(i)&&s[i]===t.type&&(t.type=s[i]);this.type=t.type}if(t.hasOwnProperty("interactionType")&&null!==t.interactionType&&(this.interactionType=t.interactionType,"choice"===t.interactionType||"sequencing"===t.interactionType?o.push("choices"):"likert"===t.interactionType?o.push("scale"):"matching"===t.interactionType?(o.push("source"),o.push("target")):"performance"===t.interactionType&&o.push("steps"),0<o.length))for(e=0;e<o.length;e+=1)if(i=o[e],t.hasOwnProperty(i)&&null!==t[i])for(this[i]=[],n=0;n<t[i].length;n+=1)t[i][n]instanceof TinCan.InteractionComponent?this[i].push(t[i][n]):this[i].push(new TinCan.InteractionComponent(t[i][n]));for(e=0;e<r.length;e+=1)t.hasOwnProperty(r[e])&&null!==t[r[e]]&&(this[r[e]]=t[r[e]])},toString:function(t){return this.log("toString"),null!==this.name?this.getLangDictionaryValue("name",t):null!==this.description?this.getLangDictionaryValue("description",t):""},asVersion:function(t){this.log("asVersion");var e,n,i,r={},o=["name","description","interactionType","correctResponsesPattern","extensions"],a=["choices","scale","source","target","steps"];for(t=t||TinCan.versions()[0],null!==this.type&&(r.type="0.9"===t?s[this.type]:this.type),e=0;e<o.length;e+=1)null!==this[i=o[e]]&&(r[i]=this[i]);for(e=0;e<a.length;e+=1)if(null!==this[i=a[e]])for(r[i]=[],n=0;n<this[i].length;n+=1)r[i].push(this[i][n].asVersion(t));return 0!==t.indexOf("0.9")&&null!==this.moreInfo&&(r.moreInfo=this.moreInfo),r},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Activity=function(t){this.log("constructor"),this.objectType="Activity",this.id=null,this.definition=null,this.init(t)};n.prototype={LOG_SRC:"Activity",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["id"];for((t=t||{}).hasOwnProperty("definition")&&(t.definition instanceof TinCan.ActivityDefinition?this.definition=t.definition:this.definition=new TinCan.ActivityDefinition(t.definition)),e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])},toString:function(t){this.log("toString");var e="";return null!==this.definition&&""!==(e=this.definition.toString(t))?e:null!==this.id?this.id:"Activity: unidentified"},asVersion:function(t){this.log("asVersion");var e={id:this.id,objectType:this.objectType};return t=t||TinCan.versions()[0],null!==this.definition&&(e.definition=this.definition.asVersion(t)),e}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.ContextActivities=function(t){this.log("constructor"),this.category=null,this.parent=null,this.grouping=null,this.other=null,this.init(t)};n.prototype={LOG_SRC:"ContextActivities",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n,i,r,o=["category","parent","grouping","other"];for(t=t||{},e=0;e<o.length;e+=1)if(i=o[e],t.hasOwnProperty(i)&&null!==t[i])if("[object Array]"===Object.prototype.toString.call(t[i]))for(n=0;n<t[i].length;n+=1)this.add(i,t[i][n]);else r=t[i],this.add(i,r)},add:function(t,e){if("category"===t||"parent"===t||"grouping"===t||"other"===t)return null===this[t]&&(this[t]=[]),e instanceof TinCan.Activity||(e="string"==typeof e?{id:e}:e,e=new TinCan.Activity(e)),this[t].push(e),this[t].length-1},asVersion:function(t){this.log("asVersion");var e,n,i={},r=["parent","grouping","other"];for(t=t||TinCan.versions()[0],e=0;e<r.length;e+=1)if(null!==this[r[e]]&&0<this[r[e]].length)if("0.9"===t||"0.95"===t)1<this[r[e]].length&&this.log("[warning] version does not support multiple values in: "+r[e]),i[r[e]]=this[r[e]][0].asVersion(t);else for(i[r[e]]=[],n=0;n<this[r[e]].length;n+=1)i[r[e]].push(this[r[e]][n].asVersion(t));if(null!==this.category&&0<this.category.length){if("0.9"===t||"0.95"===t)throw this.log("[error] version does not support the 'category' property: "+t),new Error(t+" does not support the 'category' property");for(i.category=[],e=0;e<this.category.length;e+=1)i.category.push(this.category[e].asVersion(t))}return i}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Context=function(t){this.log("constructor"),this.registration=null,this.instructor=null,this.team=null,this.contextActivities=null,this.revision=null,this.platform=null,this.language=null,this.statement=null,this.extensions=null,this.init(t)};n.prototype={LOG_SRC:"Context",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n,i,r=["registration","revision","platform","language","extensions"],o=["instructor","team"];for(t=t||{},e=0;e<r.length;e+=1)n=r[e],t.hasOwnProperty(n)&&null!==t[n]&&(this[n]=t[n]);for(e=0;e<o.length;e+=1)n=o[e],t.hasOwnProperty(n)&&null!==t[n]&&(void 0!==(i=t[n]).objectType&&"Person"!==i.objectType||(i.objectType="Agent"),"Agent"!==i.objectType||i instanceof TinCan.Agent?"Group"!==i.objectType||i instanceof TinCan.Group||(i=new TinCan.Group(i)):i=new TinCan.Agent(i),this[n]=i);t.hasOwnProperty("contextActivities")&&null!==t.contextActivities&&(t.contextActivities instanceof TinCan.ContextActivities?this.contextActivities=t.contextActivities:this.contextActivities=new TinCan.ContextActivities(t.contextActivities)),t.hasOwnProperty("statement")&&null!==t.statement&&(t.statement instanceof TinCan.StatementRef?this.statement=t.statement:t.statement instanceof TinCan.SubStatement?this.statement=t.statement:"StatementRef"===t.statement.objectType?this.statement=new TinCan.StatementRef(t.statement):"SubStatement"===t.statement.objectType?this.statement=new TinCan.SubStatement(t.statement):this.log("Unable to parse statement.context.statement property."))},asVersion:function(t){this.log("asVersion");var e,n={},i=["registration","revision","platform","language","extensions"],r=["instructor","team","contextActivities","statement"];if(t=t||TinCan.versions()[0],this.statement instanceof TinCan.SubStatement&&"0.9"!==t&&"0.95"!==t)throw this.log("[error] version does not support SubStatements in the 'statement' property: "+t),new Error(t+" does not support SubStatements in the 'statement' property");for(e=0;e<i.length;e+=1)null!==this[i[e]]&&(n[i[e]]=this[i[e]]);for(e=0;e<r.length;e+=1)null!==this[r[e]]&&(n[r[e]]=this[r[e]].asVersion(t));return n}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.StatementRef=function(t){this.log("constructor"),this.id=null,this.init(t)};n.prototype={objectType:"StatementRef",LOG_SRC:"StatementRef",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["id"];for(t=t||{},e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])},toString:function(){return this.log("toString"),this.id},asVersion:function(t){this.log("asVersion");var e={objectType:this.objectType,id:this.id};return"0.9"===t&&(e.objectType="Statement"),e}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.SubStatement=function(t){this.log("constructor"),this.actor=null,this.verb=null,this.target=null,this.result=null,this.context=null,this.timestamp=null,this.init(t)};n.prototype={objectType:"SubStatement",LOG_SRC:"SubStatement",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["timestamp"];for((t=t||{}).hasOwnProperty("object")&&(t.target=t.object),t.hasOwnProperty("actor")&&(void 0!==t.actor.objectType&&"Person"!==t.actor.objectType||(t.actor.objectType="Agent"),"Agent"===t.actor.objectType?t.actor instanceof TinCan.Agent?this.actor=t.actor:this.actor=new TinCan.Agent(t.actor):"Group"===t.actor.objectType&&(t.actor instanceof TinCan.Group?this.actor=t.actor:this.actor=new TinCan.Group(t.actor))),t.hasOwnProperty("verb")&&(t.verb instanceof TinCan.Verb?this.verb=t.verb:this.verb=new TinCan.Verb(t.verb)),t.hasOwnProperty("target")&&(t.target instanceof TinCan.Activity||t.target instanceof TinCan.Agent||t.target instanceof TinCan.Group||t.target instanceof TinCan.SubStatement||t.target instanceof TinCan.StatementRef?this.target=t.target:(void 0===t.target.objectType&&(t.target.objectType="Activity"),"Activity"===t.target.objectType?this.target=new TinCan.Activity(t.target):"Agent"===t.target.objectType?this.target=new TinCan.Agent(t.target):"Group"===t.target.objectType?this.target=new TinCan.Group(t.target):"SubStatement"===t.target.objectType?this.target=new TinCan.SubStatement(t.target):"StatementRef"===t.target.objectType?this.target=new TinCan.StatementRef(t.target):this.log("Unrecognized target type: "+t.target.objectType))),t.hasOwnProperty("result")&&(t.result instanceof TinCan.Result?this.result=t.result:this.result=new TinCan.Result(t.result)),t.hasOwnProperty("context")&&(t.context instanceof TinCan.Context?this.context=t.context:this.context=new TinCan.Context(t.context)),e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])},toString:function(t){return this.log("toString"),(null!==this.actor?this.actor.toString(t):"")+" "+(null!==this.verb?this.verb.toString(t):"")+" "+(null!==this.target?this.target.toString(t):"")},asVersion:function(t){this.log("asVersion");var e,n,i=["timestamp"],r=["actor","verb","result","context"];for(e={objectType:this.objectType},t=t||TinCan.versions()[0],n=0;n<i.length;n+=1)null!==this[i[n]]&&(e[i[n]]=this[i[n]]);for(n=0;n<r.length;n+=1)null!==this[r[n]]&&(e[r[n]]=this[r[n]].asVersion(t));return null!==this.target&&(e.object=this.target.asVersion(t)),"0.9"===t&&(e.objectType="Statement"),e}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Statement=function(t,e){this.log("constructor"),void 0===(e="number"==typeof e?{storeOriginal:e}:e||{}).storeOriginal&&(e.storeOriginal=null),void 0===e.doStamp&&(e.doStamp=!0),this.id=null,this.actor=null,this.verb=null,this.target=null,this.result=null,this.context=null,this.timestamp=null,this.stored=null,this.authority=null,this.attachments=null,this.version=null,this.degraded=!1,this.voided=null,this.inProgress=null,this.originalJSON=null,this.init(t,e)};n.prototype={LOG_SRC:"Statement",log:TinCan.prototype.log,init:function(t,e){this.log("init");var n,i=["id","stored","timestamp","version","inProgress","voided"];if(t=t||{},e.storeOriginal&&(this.originalJSON=JSON.stringify(t,null,e.storeOriginal)),t.hasOwnProperty("object")&&(t.target=t.object),t.hasOwnProperty("actor")&&(void 0!==t.actor.objectType&&"Person"!==t.actor.objectType||(t.actor.objectType="Agent"),"Agent"===t.actor.objectType?t.actor instanceof TinCan.Agent?this.actor=t.actor:this.actor=new TinCan.Agent(t.actor):"Group"===t.actor.objectType&&(t.actor instanceof TinCan.Group?this.actor=t.actor:this.actor=new TinCan.Group(t.actor))),t.hasOwnProperty("authority")&&(void 0!==t.authority.objectType&&"Person"!==t.authority.objectType||(t.authority.objectType="Agent"),"Agent"===t.authority.objectType?t.authority instanceof TinCan.Agent?this.authority=t.authority:this.authority=new TinCan.Agent(t.authority):"Group"===t.authority.objectType&&(t.actor instanceof TinCan.Group?this.authority=t.authority:this.authority=new TinCan.Group(t.authority))),t.hasOwnProperty("verb")&&(t.verb instanceof TinCan.Verb?this.verb=t.verb:this.verb=new TinCan.Verb(t.verb)),t.hasOwnProperty("target")&&(t.target instanceof TinCan.Activity||t.target instanceof TinCan.Agent||t.target instanceof TinCan.Group||t.target instanceof TinCan.SubStatement||t.target instanceof TinCan.StatementRef?this.target=t.target:(void 0===t.target.objectType&&(t.target.objectType="Activity"),"Activity"===t.target.objectType?this.target=new TinCan.Activity(t.target):"Agent"===t.target.objectType?this.target=new TinCan.Agent(t.target):"Group"===t.target.objectType?this.target=new TinCan.Group(t.target):"SubStatement"===t.target.objectType?this.target=new TinCan.SubStatement(t.target):"StatementRef"===t.target.objectType?this.target=new TinCan.StatementRef(t.target):this.log("Unrecognized target type: "+t.target.objectType))),t.hasOwnProperty("result")&&(t.result instanceof TinCan.Result?this.result=t.result:this.result=new TinCan.Result(t.result)),t.hasOwnProperty("context")&&(t.context instanceof TinCan.Context?this.context=t.context:this.context=new TinCan.Context(t.context)),t.hasOwnProperty("attachments")&&null!==t.attachments)for(this.attachments=[],n=0;n<t.attachments.length;n+=1)t.attachments[n]instanceof TinCan.Attachment?this.attachments.push(t.attachments[n]):this.attachments.push(new TinCan.Attachment(t.attachments[n]));for(n=0;n<i.length;n+=1)t.hasOwnProperty(i[n])&&null!==t[i[n]]&&(this[i[n]]=t[i[n]]);e.doStamp&&this.stamp()},toString:function(t){return this.log("toString"),(null!==this.actor?this.actor.toString(t):"")+" "+(null!==this.verb?this.verb.toString(t):"")+" "+(null!==this.target?this.target.toString(t):"")},asVersion:function(t){this.log("asVersion");var e,n={},i=["id","timestamp"],r=["actor","verb","result","context","authority"];for(t=t||TinCan.versions()[0],e=0;e<i.length;e+=1)null!==this[i[e]]&&(n[i[e]]=this[i[e]]);for(e=0;e<r.length;e+=1)null!==this[r[e]]&&(n[r[e]]=this[r[e]].asVersion(t));if(null!==this.target&&(n.object=this.target.asVersion(t)),"0.9"!==t&&"0.95"!==t||null!==this.voided&&(n.voided=this.voided),"0.9"===t&&null!==this.inProgress&&(n.inProgress=this.inProgress),null!==this.attachments&&"0.9"!==t&&"0.95"!==t)for(n.attachments=[],e=0;e<this.attachments.length;e+=1)this.attachments[e]instanceof TinCan.Attachment?n.attachments.push(this.attachments[e].asVersion(t)):n.attachments.push(new TinCan.Attachment(this.attachments[e]).asVersion(t));return n},stamp:function(){this.log("stamp"),null===this.id&&(this.id=TinCan.Utils.getUUID()),null===this.timestamp&&(this.timestamp=TinCan.Utils.getISODateString(new Date))},hasAttachmentWithContent:function(){var t;if(this.log("hasAttachmentWithContent"),null===this.attachments)return!1;for(t=0;t<this.attachments.length;t+=1)if(null!==this.attachments[t].content)return!0;return!1}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var o=TinCan.StatementsResult=function(t){this.log("constructor"),this.statements=null,this.more=null,this.init(t)};o.prototype={LOG_SRC:"StatementsResult",log:TinCan.prototype.log,init:function(t){this.log("init"),(t=t||{}).hasOwnProperty("statements")&&(this.statements=t.statements),t.hasOwnProperty("more")&&(this.more=t.more)}},o.fromJSON=function(t){o.prototype.log("fromJSON");var e,n,i,r=[];try{e=JSON.parse(t)}catch(t){o.prototype.log("fromJSON - JSON.parse error: "+t)}if(e){for(i=0;i<e.statements.length;i+=1){try{n=new TinCan.Statement(e.statements[i],4)}catch(t){o.prototype.log("fromJSON - statement instantiation failed: "+t+" ("+JSON.stringify(e.statements[i])+")"),n=new TinCan.Statement({id:e.statements[i].id},4)}r.push(n)}e.statements=r}return new o(e)}}(),function(){"use strict";var n=TinCan.State=function(t){this.log("constructor"),this.id=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(t)};n.prototype={LOG_SRC:"State",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["id","contents","etag","contentType"];for(t=t||{},e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]]);this.updated=!1}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.ActivityProfile=function(t){this.log("constructor"),this.id=null,this.activity=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(t)};n.prototype={LOG_SRC:"ActivityProfile",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["id","contents","etag","contentType"];for((t=t||{}).hasOwnProperty("activity")&&(t.activity instanceof TinCan.Activity?this.activity=t.activity:this.activity=new TinCan.Activity(t.activity)),e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]]);this.updated=!1}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.AgentProfile=function(t){this.log("constructor"),this.id=null,this.agent=null,this.updated=null,this.contents=null,this.etag=null,this.contentType=null,this.init(t)};n.prototype={LOG_SRC:"AgentProfile",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["id","contents","etag","contentType"];for((t=t||{}).hasOwnProperty("agent")&&(t.agent instanceof TinCan.Agent?this.agent=t.agent:this.agent=new TinCan.Agent(t.agent)),e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]]);this.updated=!1}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.About=function(t){this.log("constructor"),this.version=null,this.init(t)};n.prototype={LOG_SRC:"About",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["version"];for(t=t||{},e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]])}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)}}(),function(){"use strict";var n=TinCan.Attachment=function(t){this.log("constructor"),this.usageType=null,this.display=null,this.contentType=null,this.length=null,this.sha2=null,this.description=null,this.fileUrl=null,this.content=null,this.init(t)};n.prototype={LOG_SRC:"Attachment",log:TinCan.prototype.log,init:function(t){this.log("init");var e,n=["contentType","length","sha2","usageType","display","description","fileUrl"];for(t=t||{},e=0;e<n.length;e+=1)t.hasOwnProperty(n[e])&&null!==t[n[e]]&&(this[n[e]]=t[n[e]]);t.hasOwnProperty("content")&&null!==t.content&&("string"==typeof t.content?this.setContentFromString(t.content):this.setContent(t.content))},asVersion:function(t){var e;return this.log("asVersion"),"0.9"===(t=t||TinCan.versions()[0])||"0.95"===t?e=null:(e={contentType:this.contentType,display:this.display,length:this.length,sha2:this.sha2,usageType:this.usageType},null!==this.fileUrl&&(e.fileUrl=this.fileUrl),null!==this.description&&(e.description=this.description)),e},getLangDictionaryValue:TinCan.Utils.getLangDictionaryValue,setContent:function(t){this.content=t,this.length=t.byteLength,this.sha2=TinCan.Utils.getSHA256String(t)},setContentFromString:function(t){var e;e=TinCan.Utils.stringToArrayBuffer(t),this.setContent(e)},getContentAsString:function(){return TinCan.Utils.stringFromArrayBuffer(this.content)}},n.fromJSON=function(t){n.prototype.log("fromJSON");var e=JSON.parse(t);return new n(e)},n._defaultEncoding="utf-8"}(),function(){"use strict";var LOG_SRC="Environment.Browser",requestComplete,__IEModeConversion,nativeRequest,xdrRequest,__createJSONSegment,__createAttachmentSegment,__delay,env={},log=TinCan.prototype.log;"undefined"!=typeof window?(window.JSON||(window.JSON={parse:function(sJSON){return eval("("+sJSON+")")},stringify:function(t){var e,n,i="";if(t instanceof Object){if(t.constructor===Array){for(e=0;e<t.length;e+=1)i+=this.stringify(t[e])+",";return"["+i.substr(0,i.length-1)+"]"}if(t.toString!==Object.prototype.toString)return'"'+t.toString().replace(/"/g,"\\$&")+'"';for(n in t)t.hasOwnProperty(n)&&(i+='"'+n.replace(/"/g,"\\$&")+'":'+this.stringify(t[n])+",");return"{"+i.substr(0,i.length-1)+"}"}return"string"==typeof t?'"'+t.replace(/"/g,"\\$&")+'"':String(t)}}),Date.now||(Date.now=function(){return+new Date}),Array.prototype.forEach||(Array.prototype.forEach=function(t){if(null==this)throw new TypeError;var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError;var i,r=arguments[1];for(i=0;i<n;i+=1)i in e&&t.call(r,e[i],i,e)}),env.hasCORS=!1,env.useXDR=!1,"undefined"!=typeof XMLHttpRequest&&void 0!==(new XMLHttpRequest).withCredentials?env.hasCORS=!0:"undefined"!=typeof XDomainRequest&&(env.hasCORS=!0,env.useXDR=!0),requestComplete=function(t,e,n){var i,r,o;return log("requestComplete: "+n.finished+", xhr.status: "+t.status,LOG_SRC),o=void 0===t.status?n.fakeStatus:1223===t.status?204:t.status,n.finished?i:(n.finished=!0,r=e.ignore404&&404===o,200<=o&&o<400||r?e.callback?void e.callback(null,t):i={err:null,xhr:t}:(i={err:o,xhr:t},log(0===o?"[warning] There was a problem communicating with the Learning Record Store. Aborted, offline, or invalid CORS endpoint ("+o+")":"[warning] There was a problem communicating with the Learning Record Store. ("+o+" | "+t.responseText+")",LOG_SRC),e.callback&&e.callback(o,t),i))},__IEModeConversion=function(t,e,n,i){var r;for(r in e)e.hasOwnProperty(r)&&n.push(r+"="+encodeURIComponent(e[r]));return void 0!==i.data&&n.push("content="+encodeURIComponent(i.data)),e["Content-Type"]="application/x-www-form-urlencoded",t+="?method="+i.method,i.method="POST",i.params={},0<n.length&&(i.data=n.join("&")),t},nativeRequest=function(t,e,n){log("sendRequest using XMLHttpRequest",LOG_SRC);var i,r,o,a,s=this,l=[],c={finished:!1,fakeStatus:null},u=void 0!==n.callback,h=t;for(r in log("sendRequest using XMLHttpRequest - async: "+u,LOG_SRC),n.params)n.params.hasOwnProperty(r)&&l.push(r+"="+encodeURIComponent(n.params[r]));if(0<l.length&&(h+="?"+l.join("&")),2048<=h.length){if(void 0===n.method)return a=new Error("method must not be undefined for an IE Mode Request conversion"),void 0!==n.callback&&n.callback(a,null),{err:a,xhr:null};t=__IEModeConversion(t,e,l,n)}else t=h;if("undefined"!=typeof XMLHttpRequest)i=new XMLHttpRequest;else if(i=new ActiveXObject("Microsoft.XMLHTTP"),n.expectMultipart)return a=new Error("Attachment support not available"),void 0!==n.callback&&n.callback(a,null),{err:a,xhr:null};for(r in i.open(n.method,t,u),n.expectMultipart&&(i.responseType="arraybuffer"),e)e.hasOwnProperty(r)&&i.setRequestHeader(r,e[r]);o=n.data,u&&(i.onreadystatechange=function(){log("xhr.onreadystatechange - xhr.readyState: "+i.readyState,LOG_SRC),4===i.readyState&&requestComplete.call(s,i,n,c)});try{i.send(o)}catch(t){log("sendRequest caught send exception: "+t,LOG_SRC)}return u?i:requestComplete.call(this,i,n,c)},xdrRequest=function(t,e,n){log("sendRequest using XDomainRequest",LOG_SRC);var i,r,o,a,s,l=this,c=[],u={finished:!1,fakeStatus:null};if(n.expectMultipart)return s=new Error("Attachment support not available"),void 0!==n.callback&&n.callback(s,null),{err:s,xhr:null};for(o in t+="?method="+n.method,n.params)n.params.hasOwnProperty(o)&&c.push(o+"="+encodeURIComponent(n.params[o]));for(o in e)e.hasOwnProperty(o)&&c.push(o+"="+encodeURIComponent(e[o]));void 0!==n.data&&c.push("content="+encodeURIComponent(n.data)),r=c.join("&"),(i=new XDomainRequest).open("POST",t),n.callback?(i.onload=function(){u.fakeStatus=200,requestComplete.call(l,i,n,u)},i.onerror=function(){u.fakeStatus=400,requestComplete.call(l,i,n,u)},i.ontimeout=function(){u.fakeStatus=0,requestComplete.call(l,i,n,u)}):(i.onload=function(){u.fakeStatus=200},i.onerror=function(){u.fakeStatus=400},i.ontimeout=function(){u.fakeStatus=0}),i.onprogress=function(){},i.timeout=0;try{i.send(r)}catch(t){log("sendRequest caught send exception: "+t,LOG_SRC)}if(n.callback)return i;for(a=1e4+Date.now(),log("sendRequest - until: "+a+", finished: "+u.finished,LOG_SRC);Date.now()<a&&null===u.fakeStatus;)__delay();return requestComplete.call(l,i,n,u)},TinCan.LRS.prototype._initByEnvironment=function(t){var e,n,i;if(log("_initByEnvironment",LOG_SRC),t=t||{},this._makeRequest=nativeRequest,this._IEModeConversion=__IEModeConversion,null===(e=this.endpoint.toLowerCase().match(/([A-Za-z]+:)\/\/([^:\/]+):?(\d+)?(\/.*)?$/)))throw log("[error] LRS invalid: failed to divide URL parts",LOG_SRC),{code:4,mesg:"LRS invalid: failed to divide URL parts"};if(i=location.port,n=location.protocol.toLowerCase()===e[1],""===i&&(i="http:"===location.protocol.toLowerCase()?"80":"https:"===location.protocol.toLowerCase()?"443":""),!n||location.hostname.toLowerCase()!==e[2]||i!==(null!==e[3]&&void 0!==e[3]&&""!==e[3]?e[3]:"http:"===e[1]?"80":"https:"===e[1]?"443":""))if(env.hasCORS){if(env.useXDR&&n)this._makeRequest=xdrRequest;else if(env.useXDR&&!n){if(!t.allowFail)throw log("[error] LRS invalid: cross domain request for differing scheme in IE with XDR",LOG_SRC),{code:2,mesg:"LRS invalid: cross domain request for differing scheme in IE with XDR"};log("[warning] LRS invalid: cross domain request for differing scheme in IE with XDR (allowed to fail)",LOG_SRC)}}else{if(!t.allowFail)throw log("[error] LRS invalid: cross domain requests not supported in this browser",LOG_SRC),{code:1,mesg:"LRS invalid: cross domain requests not supported in this browser"};log("[warning] LRS invalid: cross domain requests not supported in this browser (allowed to fail)",LOG_SRC)}},__delay=function(){var t=new XMLHttpRequest,e=window.location+"?forcenocache="+TinCan.Utils.getUUID();t.open("GET",e,!1),t.send(null)},TinCan.LRS.syncEnabled=!0,TinCan.LRS.prototype._getMultipartRequestData=function(t,e,n){var i,r=[];for(r.push(__createJSONSegment(t,e)),i=0;i<n.length;i+=1)null!==n[i].content&&r.push(__createAttachmentSegment(t,n[i].content,n[i].sha2,n[i].contentType));return r.push("\r\n--"+t+"--\r\n"),new Blob(r)},__createJSONSegment=function(t,e){var n=["--"+t,"Content-Type: application/json","",JSON.stringify(e)].join("\r\n");return n+="\r\n"},__createAttachmentSegment=function(t,e,n,i){var r=[],o=["--"+t,"Content-Type: "+i,"Content-Transfer-Encoding: binary","X-Experience-API-Hash: "+n].join("\r\n");return o+="\r\n\r\n",r.push(o),r.push(e),new Blob(r)},TinCan.Utils.stringToArrayBuffer=function(t,e){return e||(e=TinCan.Utils.defaultEncoding),new TextEncoder(e).encode(t).buffer},TinCan.Utils.stringFromArrayBuffer=function(t,e){return e||(e=TinCan.Utils.defaultEncoding),new TextDecoder(e).decode(t)}):log("'window' not defined",LOG_SRC)}(),function(f){"use strict";var d=void 0,g=1e5;function y(t){switch(typeof t){case"undefined":return"undefined";case"boolean":return"boolean";case"number":return"number";case"string":return"string";default:return null===t?"null":"object"}}function v(t){return Object.prototype.toString.call(t).replace(/^\[object *|\]$/g,"")}function m(t){return"function"==typeof t}function b(t){if(null===t||t===d)throw TypeError();return Object(t)}function S(t){return t>>0}function T(t){return t>>>0}var i,t,w=Math.LN2,x=Math.abs,O=Math.floor,C=Math.log,_=Math.max,A=Math.min,R=Math.pow,e=Math.round;function n(t,e){var n=32-e;return t<<n>>n}function r(t,e){var n=32-e;return t<<n>>>n}function P(t){return[255&t]}function E(t){return n(t[0],8)}function j(t){return[255&t]}function k(t){return r(t[0],8)}function N(t){return[(t=e(Number(t)))<0?0:255<t?255:255&t]}function L(t){return[255&t,t>>8&255]}function J(t){return n(t[1]<<8|t[0],16)}function I(t){return[255&t,t>>8&255]}function U(t){return r(t[1]<<8|t[0],16)}function H(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function B(t){return n(t[3]<<24|t[2]<<16|t[1]<<8|t[0],32)}function M(t){return[255&t,t>>8&255,t>>16&255,t>>24&255]}function q(t){return r(t[3]<<24|t[2]<<16|t[1]<<8|t[0],32)}function o(t,e,n){var i,r,o,a=(1<<e-1)-1;function s(t){var e=O(t),n=t-e;return n<.5?e:.5<n?e+1:e%2?e+1:e}if(t!=t)r=(1<<e)-1,o=R(2,n-1),i=0;else if(t===1/0||t===-1/0)r=(1<<e)-1,i=t<(o=0)?1:0;else if(0===t)i=1/t==-1/(o=r=0)?1:0;else if(i=t<0,(t=x(t))>=R(2,1-a)){r=A(O(C(t)/w),1023);var l=t/R(2,r);l<1&&(r-=1,l*=2),2<=l&&(r+=1,l/=2);var c=R(2,n);r+=a,1<=(o=s(l*c)-c)/c&&(r+=1,o=0),2*a<r&&(r=(1<<e)-1,o=0)}else r=0,o=s(t/R(2,1-a-n));var u,h=[];for(u=n;u;u-=1)h.push(o%2?1:0),o=O(o/2);for(u=e;u;u-=1)h.push(r%2?1:0),r=O(r/2);h.push(i?1:0),h.reverse();for(var p=h.join(""),f=[];p.length;)f.unshift(parseInt(p.substring(0,8),2)),p=p.substring(8);return f}function a(t,e,n){var i,r,o,a,s,l,c,u,h=[];for(i=0;i<t.length;++i)for(o=t[i],r=8;r;r-=1)h.push(o%2?1:0),o>>=1;return h.reverse(),a=h.join(""),s=(1<<e-1)-1,l=parseInt(a.substring(0,1),2)?-1:1,c=parseInt(a.substring(1,1+e),2),u=parseInt(a.substring(1+e),2),c===(1<<e)-1?0!==u?NaN:1/0*l:0<c?l*R(2,c-s)*(1+u/R(2,n)):0!==u?l*R(2,-(s-1))*(u/R(2,n)):l<0?-0:0}function V(t){return a(t,11,52)}function G(t){return o(t,11,52)}function D(t){return a(t,8,23)}function F(t){return o(t,8,23)}i=Object.defineProperty,t=!function(){try{return Object.defineProperty({},"x",{})}catch(t){return!1}}(),i&&!t||(Object.defineProperty=function(t,e,n){if(i)try{return i(t,e,n)}catch(t){}if(t!==Object(t))throw TypeError("Object.defineProperty called on non-object");return Object.prototype.__defineGetter__&&"get"in n&&Object.prototype.__defineGetter__.call(t,e,n.get),Object.prototype.__defineSetter__&&"set"in n&&Object.prototype.__defineSetter__.call(t,e,n.set),"value"in n&&(t[e]=n.value),t}),function(){function r(t){if((t=S(t))<0)throw RangeError("ArrayBuffer size is not a small enough positive integer.");Object.defineProperty(this,"byteLength",{value:t}),Object.defineProperty(this,"_bytes",{value:Array(t)});for(var e=0;e<t;e+=1)this._bytes[e]=0}function o(){if(!arguments.length||"object"!=typeof arguments[0])return function(t){if((t=S(t))<0)throw RangeError("length is not a small enough positive integer.");Object.defineProperty(this,"length",{value:t}),Object.defineProperty(this,"byteLength",{value:t*this.BYTES_PER_ELEMENT}),Object.defineProperty(this,"buffer",{value:new r(this.byteLength)}),Object.defineProperty(this,"byteOffset",{value:0})}.apply(this,arguments);if(1<=arguments.length&&"object"===y(arguments[0])&&arguments[0]instanceof o)return function(t){if(this.constructor!==t.constructor)throw TypeError();var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new r(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var n=0;n<this.length;n+=1)this._setter(n,t._getter(n))}.apply(this,arguments);if(1<=arguments.length&&"object"===y(arguments[0])&&!(arguments[0]instanceof o)&&!(arguments[0]instanceof r||"ArrayBuffer"===v(arguments[0])))return function(t){var e=t.length*this.BYTES_PER_ELEMENT;Object.defineProperty(this,"buffer",{value:new r(e)}),Object.defineProperty(this,"byteLength",{value:e}),Object.defineProperty(this,"byteOffset",{value:0}),Object.defineProperty(this,"length",{value:t.length});for(var n=0;n<this.length;n+=1){var i=t[n];this._setter(n,Number(i))}}.apply(this,arguments);if(1<=arguments.length&&"object"===y(arguments[0])&&(arguments[0]instanceof r||"ArrayBuffer"===v(arguments[0])))return function(t,e,n){if((e=T(e))>t.byteLength)throw RangeError("byteOffset out of range");if(e%this.BYTES_PER_ELEMENT)throw RangeError("buffer length minus the byteOffset is not a multiple of the element size.");if(n===d){var i=t.byteLength-e;if(i%this.BYTES_PER_ELEMENT)throw RangeError("length of buffer minus byteOffset not a multiple of the element size");n=i/this.BYTES_PER_ELEMENT}else i=(n=T(n))*this.BYTES_PER_ELEMENT;if(e+i>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:i}),Object.defineProperty(this,"byteOffset",{value:e}),Object.defineProperty(this,"length",{value:n})}.apply(this,arguments);throw TypeError()}f.ArrayBuffer=f.ArrayBuffer||r,Object.defineProperty(o,"from",{value:function(t){return new this(t)}}),Object.defineProperty(o,"of",{value:function(){return new this(arguments)}});var a={};function t(t,e,n){var i=function(){Object.defineProperty(this,"constructor",{value:i}),o.apply(this,arguments),function(n){if(!("TYPED_ARRAY_POLYFILL_NO_ARRAY_ACCESSORS"in f)){if(n.length>g)throw RangeError("Array too large for polyfill");var t;for(t=0;t<n.length;t+=1)e(t)}function e(e){Object.defineProperty(n,e,{get:function(){return n._getter(e)},set:function(t){n._setter(e,t)},enumerable:!0,configurable:!1})}}(this)};"__proto__"in i?i.__proto__=o:(i.from=o.from,i.of=o.of),i.BYTES_PER_ELEMENT=t;function r(){}return r.prototype=a,i.prototype=new r,Object.defineProperty(i.prototype,"BYTES_PER_ELEMENT",{value:t}),Object.defineProperty(i.prototype,"_pack",{value:e}),Object.defineProperty(i.prototype,"_unpack",{value:n}),i}o.prototype=a,Object.defineProperty(o.prototype,"_getter",{value:function(t){if(arguments.length<1)throw SyntaxError("Not enough arguments");if((t=T(t))>=this.length)return d;var e,n,i=[];for(e=0,n=this.byteOffset+t*this.BYTES_PER_ELEMENT;e<this.BYTES_PER_ELEMENT;e+=1,n+=1)i.push(this.buffer._bytes[n]);return this._unpack(i)}}),Object.defineProperty(o.prototype,"get",{value:o.prototype._getter}),Object.defineProperty(o.prototype,"_setter",{value:function(t,e){if(arguments.length<2)throw SyntaxError("Not enough arguments");if(!((t=T(t))>=this.length)){var n,i,r=this._pack(e);for(n=0,i=this.byteOffset+t*this.BYTES_PER_ELEMENT;n<this.BYTES_PER_ELEMENT;n+=1,i+=1)this.buffer._bytes[i]=r[n]}}}),Object.defineProperty(o.prototype,"constructor",{value:o}),Object.defineProperty(o.prototype,"copyWithin",{value:function(t,e){var n=arguments[2],i=b(this),r=T(i.length);r=_(r,0);var o,a=S(t);o=a<0?_(r+a,0):A(a,r);var s,l,c,u=S(e);s=u<0?_(r+u,0):A(u,r),c=(l=n===d?r:S(n))<0?_(r+l,0):A(l,r);var h,p=A(c-s,r-o);for(s<o&&o<s+p?(h=-1,s=s+p-1,o=o+p-1):h=1;0<p;)i._setter(o,i._getter(s)),s+=h,o+=h,p-=1;return i}}),Object.defineProperty(o.prototype,"every",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();for(var i=arguments[1],r=0;r<n;r++)if(!t.call(i,e._getter(r),r,e))return!1;return!0}}),Object.defineProperty(o.prototype,"fill",{value:function(t){var e=arguments[1],n=arguments[2],i=b(this),r=T(i.length);r=_(r,0);var o,a,s,l=S(e);for(o=l<0?_(r+l,0):A(l,r),s=(a=n===d?r:S(n))<0?_(r+a,0):A(a,r);o<s;)i._setter(o,t),o+=1;return i}}),Object.defineProperty(o.prototype,"filter",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();for(var i=[],r=arguments[1],o=0;o<n;o++){var a=e._getter(o);t.call(r,a,o,e)&&i.push(a)}return new this.constructor(i)}}),Object.defineProperty(o.prototype,"find",{value:function(t){var e=b(this),n=T(e.length);if(!m(t))throw TypeError();for(var i=1<arguments.length?arguments[1]:d,r=0;r<n;){var o=e._getter(r),a=t.call(i,o,r,e);if(Boolean(a))return o;++r}return d}}),Object.defineProperty(o.prototype,"findIndex",{value:function(t){var e=b(this),n=T(e.length);if(!m(t))throw TypeError();for(var i=1<arguments.length?arguments[1]:d,r=0;r<n;){var o=e._getter(r),a=t.call(i,o,r,e);if(Boolean(a))return r;++r}return-1}}),Object.defineProperty(o.prototype,"forEach",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();for(var i=arguments[1],r=0;r<n;r++)t.call(i,e._getter(r),r,e)}}),Object.defineProperty(o.prototype,"indexOf",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(0===n)return-1;var i=0;if(0<arguments.length&&((i=Number(arguments[1]))!=i?i=0:0!==i&&i!==1/0&&i!==-1/0&&(i=(0<i||-1)*O(x(i)))),n<=i)return-1;for(var r=0<=i?i:_(n-x(i),0);r<n;r++)if(e._getter(r)===t)return r;return-1}}),Object.defineProperty(o.prototype,"join",{value:function(t){if(this===d||null===this)throw TypeError();for(var e=Object(this),n=T(e.length),i=Array(n),r=0;r<n;++r)i[r]=e._getter(r);return i.join(t===d?",":t)}}),Object.defineProperty(o.prototype,"lastIndexOf",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(0===n)return-1;var i=n;1<arguments.length&&((i=Number(arguments[1]))!=i?i=0:0!==i&&i!==1/0&&i!==-1/0&&(i=(0<i||-1)*O(x(i))));for(var r=0<=i?A(i,n-1):n-x(i);0<=r;r--)if(e._getter(r)===t)return r;return-1}}),Object.defineProperty(o.prototype,"map",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();var i=[];i.length=n;for(var r=arguments[1],o=0;o<n;o++)i[o]=t.call(r,e._getter(o),o,e);return new this.constructor(i)}}),Object.defineProperty(o.prototype,"reduce",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();if(0===n&&1===arguments.length)throw TypeError();var i,r=0;for(i=2<=arguments.length?arguments[1]:e._getter(r++);r<n;)i=t.call(d,i,e._getter(r),r,e),r++;return i}}),Object.defineProperty(o.prototype,"reduceRight",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();if(0===n&&1===arguments.length)throw TypeError();var i,r=n-1;for(i=2<=arguments.length?arguments[1]:e._getter(r--);0<=r;)i=t.call(d,i,e._getter(r),r,e),r--;return i}}),Object.defineProperty(o.prototype,"reverse",{value:function(){if(this===d||null===this)throw TypeError();for(var t=Object(this),e=T(t.length),n=O(e/2),i=0,r=e-1;i<n;++i,--r){var o=t._getter(i);t._setter(i,t._getter(r)),t._setter(r,o)}return t}}),Object.defineProperty(o.prototype,"set",{value:function(t,e){if(arguments.length<1)throw SyntaxError("Not enough arguments");var n,i,r,o,a,s,l,c,u,h;if("object"==typeof t&&t.constructor===this.constructor){if(n=t,(r=T(e))+n.length>this.length)throw RangeError("Offset plus length of array is out of range");if(c=this.byteOffset+r*this.BYTES_PER_ELEMENT,u=n.length*this.BYTES_PER_ELEMENT,n.buffer===this.buffer){for(h=[],a=0,s=n.byteOffset;a<u;a+=1,s+=1)h[a]=n.buffer._bytes[s];for(a=0,l=c;a<u;a+=1,l+=1)this.buffer._bytes[l]=h[a]}else for(a=0,s=n.byteOffset,l=c;a<u;a+=1,s+=1,l+=1)this.buffer._bytes[l]=n.buffer._bytes[s]}else{if("object"!=typeof t||void 0===t.length)throw TypeError("Unexpected argument type(s)");if(o=T((i=t).length),(r=T(e))+o>this.length)throw RangeError("Offset plus length of array is out of range");for(a=0;a<o;a+=1)s=i[a],this._setter(r+a,Number(s))}}}),Object.defineProperty(o.prototype,"slice",{value:function(t,e){for(var n=b(this),i=T(n.length),r=S(t),o=r<0?_(i+r,0):A(r,i),a=e===d?i:S(e),s=a<0?_(i+a,0):A(a,i),l=s-o,c=new n.constructor(l),u=0;o<s;){var h=n._getter(o);c._setter(u,h),++o,++u}return c}}),Object.defineProperty(o.prototype,"some",{value:function(t){if(this===d||null===this)throw TypeError();var e=Object(this),n=T(e.length);if(!m(t))throw TypeError();for(var i=arguments[1],r=0;r<n;r++)if(t.call(i,e._getter(r),r,e))return!0;return!1}}),Object.defineProperty(o.prototype,"sort",{value:function(t){if(this===d||null===this)throw TypeError();for(var e=Object(this),n=T(e.length),i=Array(n),r=0;r<n;++r)i[r]=e._getter(r);for(t?i.sort(t):i.sort(),r=0;r<n;++r)e._setter(r,i[r]);return e}}),Object.defineProperty(o.prototype,"subarray",{value:function(t,e){function n(t,e,n){return t<e?e:n<t?n:t}t=S(t),e=S(e),arguments.length<1&&(t=0),arguments.length<2&&(e=this.length),t<0&&(t=this.length+t),e<0&&(e=this.length+e),t=n(t,0,this.length);var i=(e=n(e,0,this.length))-t;return i<0&&(i=0),new this.constructor(this.buffer,this.byteOffset+t*this.BYTES_PER_ELEMENT,i)}});var e=t(1,P,E),n=t(1,j,k),i=t(1,N,k),s=t(2,L,J),l=t(2,I,U),c=t(4,H,B),u=t(4,M,q),h=t(4,F,D),p=t(8,G,V);f.Int8Array=f.Int8Array||e,f.Uint8Array=f.Uint8Array||n,f.Uint8ClampedArray=f.Uint8ClampedArray||i,f.Int16Array=f.Int16Array||s,f.Uint16Array=f.Uint16Array||l,f.Int32Array=f.Int32Array||c,f.Uint32Array=f.Uint32Array||u,f.Float32Array=f.Float32Array||h,f.Float64Array=f.Float64Array||p}(),function(){function l(t,e){return m(t.get)?t.get(e):t[e]}var t,c=(t=new Uint16Array([4660]),18===l(new Uint8Array(t.buffer),0));function e(t,e,n){if(!(t instanceof ArrayBuffer||"ArrayBuffer"===v(t)))throw TypeError();if((e=T(e))>t.byteLength)throw RangeError("byteOffset out of range");if(e+(n=n===d?t.byteLength-e:T(n))>t.byteLength)throw RangeError("byteOffset and length reference an area beyond the end of the buffer");Object.defineProperty(this,"buffer",{value:t}),Object.defineProperty(this,"byteLength",{value:n}),Object.defineProperty(this,"byteOffset",{value:e})}function n(o){return function(t,e){if((t=T(t))+o.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");t+=this.byteOffset;for(var n=new Uint8Array(this.buffer,t,o.BYTES_PER_ELEMENT),i=[],r=0;r<o.BYTES_PER_ELEMENT;r+=1)i.push(l(n,r));return Boolean(e)===Boolean(c)&&i.reverse(),l(new o(new Uint8Array(i).buffer),0)}}function i(s){return function(t,e,n){if((t=T(t))+s.BYTES_PER_ELEMENT>this.byteLength)throw RangeError("Array index out of range");var i,r=new s([e]),o=new Uint8Array(r.buffer),a=[];for(i=0;i<s.BYTES_PER_ELEMENT;i+=1)a.push(l(o,i));Boolean(n)===Boolean(c)&&a.reverse(),new Uint8Array(this.buffer,t,s.BYTES_PER_ELEMENT).set(a)}}Object.defineProperty(e.prototype,"getUint8",{value:n(Uint8Array)}),Object.defineProperty(e.prototype,"getInt8",{value:n(Int8Array)}),Object.defineProperty(e.prototype,"getUint16",{value:n(Uint16Array)}),Object.defineProperty(e.prototype,"getInt16",{value:n(Int16Array)}),Object.defineProperty(e.prototype,"getUint32",{value:n(Uint32Array)}),Object.defineProperty(e.prototype,"getInt32",{value:n(Int32Array)}),Object.defineProperty(e.prototype,"getFloat32",{value:n(Float32Array)}),Object.defineProperty(e.prototype,"getFloat64",{value:n(Float64Array)}),Object.defineProperty(e.prototype,"setUint8",{value:i(Uint8Array)}),Object.defineProperty(e.prototype,"setInt8",{value:i(Int8Array)}),Object.defineProperty(e.prototype,"setUint16",{value:i(Uint16Array)}),Object.defineProperty(e.prototype,"setInt16",{value:i(Int16Array)}),Object.defineProperty(e.prototype,"setUint32",{value:i(Uint32Array)}),Object.defineProperty(e.prototype,"setInt32",{value:i(Int32Array)}),Object.defineProperty(e.prototype,"setFloat32",{value:i(Float32Array)}),Object.defineProperty(e.prototype,"setFloat64",{value:i(Float64Array)}),f.DataView=f.DataView||e}()}(self),function(t){"use strict";function c(t,e){return(t=0|t||0)<0?Math.max(t+e,0):Math.min(t,e)}ArrayBuffer.prototype.slice||(ArrayBuffer.prototype.slice=function(t,e){var n=this.byteLength,i=c(t,n),r=n;if(void 0!==e&&(r=c(e,n)),r<i)return new ArrayBuffer(0);var o=r-i,a=new ArrayBuffer(o),s=new Uint8Array(a),l=new Uint8Array(this,i,o);return s.set(l),a})}(),"undefined"!=typeof module&&module.exports&&(this["encoding-indexes"]=require("./encoding-indexes.js")["encoding-indexes"]),function(i){"use strict";function m(t,e,n){return e<=t&&t<=n}var l=Math.floor;function s(t){if(void 0===t)return{};if(t===Object(t))return t;throw TypeError("Could not convert argument to dictionary")}function h(t){return 0<=t&&t<=127}var c=h;function u(t){this.tokens=[].slice.call(t),this.tokens.reverse()}u.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.pop():-1},prepend:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.push(e.pop());else this.tokens.push(t)},push:function(t){if(Array.isArray(t))for(var e=t;e.length;)this.tokens.unshift(e.shift());else this.tokens.unshift(t)}};function b(t,e){if(t)throw TypeError("Decoder error");return e||65533}function p(t){throw TypeError("The code point "+t+" could not be encoded.")}function r(t){return t=String(t).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(n,t)?n[t]:null}var t=[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"UTF-8"}],heading:"The Encoding"},{encodings:[{labels:["866","cp866","csibm866","ibm866"],name:"IBM866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso88592","iso_8859-2","iso_8859-2:1987","l2","latin2"],name:"ISO-8859-2"},{labels:["csisolatin3","iso-8859-3","iso-ir-109","iso8859-3","iso88593","iso_8859-3","iso_8859-3:1988","l3","latin3"],name:"ISO-8859-3"},{labels:["csisolatin4","iso-8859-4","iso-ir-110","iso8859-4","iso88594","iso_8859-4","iso_8859-4:1988","l4","latin4"],name:"ISO-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso-ir-144","iso8859-5","iso88595","iso_8859-5","iso_8859-5:1988"],name:"ISO-8859-5"},{labels:["arabic","asmo-708","csiso88596e","csiso88596i","csisolatinarabic","ecma-114","iso-8859-6","iso-8859-6-e","iso-8859-6-i","iso-ir-127","iso8859-6","iso88596","iso_8859-6","iso_8859-6:1987"],name:"ISO-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso-ir-126","iso8859-7","iso88597","iso_8859-7","iso_8859-7:1987","sun_eu_greek"],name:"ISO-8859-7"},{labels:["csiso88598e","csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-e","iso-ir-138","iso8859-8","iso88598","iso_8859-8","iso_8859-8:1988","visual"],name:"ISO-8859-8"},{labels:["csiso88598i","iso-8859-8-i","logical"],name:"ISO-8859-8-I"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","iso885910","l6","latin6"],name:"ISO-8859-10"},{labels:["iso-8859-13","iso8859-13","iso885913"],name:"ISO-8859-13"},{labels:["iso-8859-14","iso8859-14","iso885914"],name:"ISO-8859-14"},{labels:["csisolatin9","iso-8859-15","iso8859-15","iso885915","iso_8859-15","l9"],name:"ISO-8859-15"},{labels:["iso-8859-16"],name:"ISO-8859-16"},{labels:["cskoi8r","koi","koi8","koi8-r","koi8_r"],name:"KOI8-R"},{labels:["koi8-ru","koi8-u"],name:"KOI8-U"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["dos-874","iso-8859-11","iso8859-11","iso885911","tis-620","windows-874"],name:"windows-874"},{labels:["cp1250","windows-1250","x-cp1250"],name:"windows-1250"},{labels:["cp1251","windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ansi_x3.4-1968","ascii","cp1252","cp819","csisolatin1","ibm819","iso-8859-1","iso-ir-100","iso8859-1","iso88591","iso_8859-1","iso_8859-1:1987","l1","latin1","us-ascii","windows-1252","x-cp1252"],name:"windows-1252"},{labels:["cp1253","windows-1253","x-cp1253"],name:"windows-1253"},{labels:["cp1254","csisolatin5","iso-8859-9","iso-ir-148","iso8859-9","iso88599","iso_8859-9","iso_8859-9:1989","l5","latin5","windows-1254","x-cp1254"],name:"windows-1254"},{labels:["cp1255","windows-1255","x-cp1255"],name:"windows-1255"},{labels:["cp1256","windows-1256","x-cp1256"],name:"windows-1256"},{labels:["cp1257","windows-1257","x-cp1257"],name:"windows-1257"},{labels:["cp1258","windows-1258","x-cp1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb2312","gb_2312","gb_2312-80","gbk","iso-ir-58","x-gbk"],name:"GBK"},{labels:["gb18030"],name:"gb18030"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"Big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"EUC-JP"},{labels:["csiso2022jp","iso-2022-jp"],name:"ISO-2022-JP"},{labels:["csshiftjis","ms932","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"Shift_JIS"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"EUC-KR"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["csiso2022kr","hz-gb-2312","iso-2022-cn","iso-2022-cn-ext","iso-2022-kr"],name:"replacement"},{labels:["utf-16be"],name:"UTF-16BE"},{labels:["utf-16","utf-16le"],name:"UTF-16LE"},{labels:["x-user-defined"],name:"x-user-defined"}],heading:"Legacy miscellaneous encodings"}],n={};t.forEach(function(t){t.encodings.forEach(function(e){e.labels.forEach(function(t){n[t]=e})})});var a={},f={};function S(t,e){return e&&e[t]||null}function d(t,e){var n=e.indexOf(t);return-1===n?null:n}function T(t){if(!("encoding-indexes"in i))throw Error("Indexes missing. Did you forget to include encoding-indexes.js?");return i["encoding-indexes"][t]}var o="utf-8";function g(t,e){if(!(this instanceof g))throw TypeError("Called as a function. Did you forget 'new'?");t=void 0!==t?String(t):o,e=s(e),this._encoding=null,this._decoder=null,this._ignoreBOM=!1,this._BOMseen=!1,this._error_mode="replacement",this._do_not_flush=!1;var n=r(t);if(null===n||"replacement"===n.name)throw RangeError("Unknown encoding: "+t);if(!f[n.name])throw Error("Decoder not present. Did you forget to include encoding-indexes.js?");var i=this;return i._encoding=n,Boolean(e.fatal)&&(i._error_mode="fatal"),Boolean(e.ignoreBOM)&&(i._ignoreBOM=!0),Object.defineProperty||(this.encoding=i._encoding.name.toLowerCase(),this.fatal="fatal"===i._error_mode,this.ignoreBOM=i._ignoreBOM),i}function y(t,e){if(!(this instanceof y))throw TypeError("Called as a function. Did you forget 'new'?");e=s(e),this._encoding=null,this._encoder=null,this._do_not_flush=!1,this._fatal=Boolean(e.fatal)?"fatal":"replacement";if(Boolean(e.NONSTANDARD_allowLegacyEncoding)){var n=r(t=void 0!==t?String(t):o);if(null===n||"replacement"===n.name)throw RangeError("Unknown encoding: "+t);if(!a[n.name])throw Error("Encoder not present. Did you forget to include encoding-indexes.js?");this._encoding=n}else this._encoding=r("utf-8"),void 0!==t&&"console"in i&&console.warn("TextEncoder constructor called with encoding label, which is ignored.");return Object.defineProperty||(this.encoding=this._encoding.name.toLowerCase()),this}function e(t){var i=t.fatal,r=0,o=0,a=0,s=128,l=191;this.handler=function(t,e){if(-1===e&&0!==a)return a=0,b(i);if(-1===e)return-1;if(0===a){if(m(e,0,127))return e;if(m(e,194,223))a=1,r=e-192;else if(m(e,224,239))224===e&&(s=160),237===e&&(l=159),a=2,r=e-224;else{if(!m(e,240,244))return b(i);240===e&&(s=144),244===e&&(l=143),a=3,r=e-240}return r<<=6*a,null}if(!m(e,s,l))return r=a=o=0,s=128,l=191,t.prepend(e),b(i);if(l=191,r+=e-(s=128)<<6*(a-(o+=1)),o!==a)return null;var n=r;return r=a=o=0,n}}function v(t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(m(e,0,127))return e;var n,i;m(e,128,2047)?(n=1,i=192):m(e,2048,65535)?(n=2,i=224):m(e,65536,1114111)&&(n=3,i=240);for(var r=[(e>>6*n)+i];0<n;){var o=e>>6*(n-1);r.push(128|63&o),n-=1}return r}}function w(i,t){var r=t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(h(e))return e;var n=i[e-128];return null===n?b(r):n}}function x(i,t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(c(e))return e;var n=d(e,i);return null===n&&p(e),n+128}}function O(t){var s=t.fatal,l=0,c=0,u=0;this.handler=function(t,e){if(-1===e&&0===l&&0===c&&0===u)return-1;var n;if(-1!==e||0===l&&0===c&&0===u||(u=c=l=0,b(s)),0!==u){n=null,m(e,48,57)&&(n=function(t){if(39419<t&&t<189e3||1237575<t)return null;if(7457===t)return 59335;var e,n=0,i=0,r=T("gb18030");for(e=0;e<r.length;++e){var o=r[e];if(!(o[0]<=t))break;n=o[0],i=o[1]}return i+t-n}(10*(126*(10*(l-129)+(c-48))+(u-129))+e-48));var i=[c,u,e];return u=c=l=0,null===n?(t.prepend(i),b(s)):n}if(0!==c)return m(e,129,254)?(u=e,null):(t.prepend([c,e]),c=l=0,b(s));if(0===l)return h(e)?e:128===e?8364:m(e,129,254)?(l=e,null):b(s);if(m(e,48,57))return c=e,null;var r=l,o=null;l=0;var a=e<127?64:65;return(m(e,64,126)||m(e,128,254))&&(o=190*(r-129)+(e-a)),null===(n=null===o?null:S(o,T("gb18030")))&&h(e)&&t.prepend(e),null===n?b(s):n}}function C(t,s){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(c(e))return e;if(58853===e)return p(e);if(s&&8364===e)return 128;var n=d(e,T("gb18030"));if(null!==n){var i=n%190;return[l(n/190)+129,i+(i<63?64:65)]}if(s)return p(e);n=function(t){if(59335===t)return 7457;var e,n=0,i=0,r=T("gb18030");for(e=0;e<r.length;++e){var o=r[e];if(!(o[1]<=t))break;n=o[1],i=o[0]}return i+t-n}(e);var r=l(n/10/126/10),o=l((n-=10*r*126*10)/10/126),a=l((n-=10*o*126)/10);return[r+129,o+48,a+129,48+(n-10*a)]}}function _(t){var a=t.fatal,s=0;this.handler=function(t,e){if(-1===e&&0!==s)return s=0,b(a);if(-1===e&&0===s)return-1;if(0===s)return h(e)?e:m(e,129,254)?(s=e,null):b(a);var n=s,i=null;s=0;var r=e<127?64:98;switch((m(e,64,126)||m(e,161,254))&&(i=157*(n-129)+(e-r)),i){case 1133:return[202,772];case 1135:return[202,780];case 1164:return[234,772];case 1166:return[234,780]}var o=null===i?null:S(i,T("big5"));return null===o&&h(e)&&t.prepend(e),null===o?b(a):o}}function A(t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(c(e))return e;var n=function(t){var e=T("big5");return 9552===t||9566===t||9569===t||9578===t||21313===t||21317===t?e.lastIndexOf(t):d(t,e)}(e);if(null===n)return p(e);var i=l(n/157)+129;if(i<161)return p(e);var r=n%157;return[i,r+(r<63?64:98)]}}function R(t){var r=t.fatal,o=!1,a=0;this.handler=function(t,e){if(-1===e&&0!==a)return a=0,b(r);if(-1===e&&0===a)return-1;if(142===a&&m(e,161,223))return a=0,65377+e-161;if(143===a&&m(e,161,254))return o=!0,a=e,null;if(0===a)return h(e)?e:142===e||143===e||m(e,161,254)?(a=e,null):b(r);var n=a;a=0;var i=null;return m(n,161,254)&&m(e,161,254)&&(i=S(94*(n-161)+(e-161),T(o?"jis0212":"jis0208"))),o=!1,m(e,161,254)||t.prepend(e),null===i?b(r):i}}function P(t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(c(e))return e;if(165===e)return 92;if(8254===e)return 126;if(m(e,65377,65439))return[142,e-65377+161];8722===e&&(e=65293);var n=d(e,T("jis0208"));return null===n?p(e):[l(n/94)+161,n%94+161]}}function E(t){var a=t.fatal,s=0,l=1,c=2,u=3,h=4,p=5,f=6,d=s,g=s,y=0,v=!1;this.handler=function(t,e){switch(d){default:case s:return 27===e?(d=p,null):m(e,0,127)&&14!==e&&15!==e&&27!==e?(v=!1,e):-1===e?-1:(v=!1,b(a));case l:return 27===e?(d=p,null):92===e?(v=!1,165):126===e?(v=!1,8254):m(e,0,127)&&14!==e&&15!==e&&27!==e&&92!==e&&126!==e?(v=!1,e):-1===e?-1:(v=!1,b(a));case c:return 27===e?(d=p,null):m(e,33,95)?(v=!1,65377+e-33):-1===e?-1:(v=!1,b(a));case u:return 27===e?(d=p,null):m(e,33,126)?(v=!1,y=e,d=h,null):-1===e?-1:(v=!1,b(a));case h:if(27===e)return d=p,b(a);if(m(e,33,126)){d=u;var n=S(94*(y-33)+e-33,T("jis0208"));return null===n?b(a):n}return-1===e?(d=u,t.prepend(e)):d=u,b(a);case p:return 36===e||40===e?(y=e,d=f,null):(t.prepend(e),v=!1,d=g,b(a));case f:var i=y;y=0;var r=null;if(40===i&&66===e&&(r=s),40===i&&74===e&&(r=l),40===i&&73===e&&(r=c),36!==i||64!==e&&66!==e||(r=u),null===r)return t.prepend([i,e]),v=!1,d=g,b(a);d=d=r;var o=v;return v=!0,o?b(a):null}}}function j(t){t.fatal;var i=0,r=1,o=2,a=i;this.handler=function(t,e){if(-1===e&&a!==i)return t.prepend(e),a=i,[27,40,66];if(-1===e&&a===i)return-1;if(!(a!==i&&a!==r||14!==e&&15!==e&&27!==e))return p(65533);if(a===i&&c(e))return e;if(a===r&&(c(e)&&92!==e&&126!==e||165==e||8254==e)){if(c(e))return e;if(165===e)return 92;if(8254===e)return 126}if(c(e)&&a!==i)return t.prepend(e),a=i,[27,40,66];if((165===e||8254===e)&&a!==r)return t.prepend(e),a=r,[27,40,74];8722===e&&(e=65293);var n=d(e,T("jis0208"));return null===n?p(e):a!==o?(t.prepend(e),a=o,[27,36,66]):[l(n/94)+33,n%94+33]}}function k(t){var s=t.fatal,l=0;this.handler=function(t,e){if(-1===e&&0!==l)return l=0,b(s);if(-1===e&&0===l)return-1;if(0===l)return h(e)||128===e?e:m(e,161,223)?65377+e-161:m(e,129,159)||m(e,224,252)?(l=e,null):b(s);var n=l,i=null;l=0;var r=e<127?64:65,o=n<160?129:193;(m(e,64,126)||m(e,128,252))&&(i=188*(n-o)+e-r);var a=null===i?null:S(i,T("jis0208"));return null===a&&null!==i&&m(i,8836,10528)?57344+i-8836:(null===a&&h(e)&&t.prepend(e),null===a?b(s):a)}}function N(t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(c(e)||128===e)return e;if(165===e)return 92;if(8254===e)return 126;if(m(e,65377,65439))return e-65377+161;8722===e&&(e=65293);var n=function(t){var e=d(t,T("jis0208"));return null===e||m(e,8272,8835)?null:e}(e);if(null===n)return p(e);var i=l(n/188),r=n%188;return[i+(i<31?129:193),r+(r<63?64:65)]}}function L(t){var o=t.fatal,a=0;this.handler=function(t,e){if(-1===e&&0!==a)return a=0,b(o);if(-1===e&&0===a)return-1;if(0===a)return h(e)?e:m(e,129,254)?(a=e,null):b(o);var n=a,i=null;a=0,m(e,65,254)&&(i=190*(n-129)+(e-65));var r=null===i?null:S(i,T("euc-kr"));return null===i&&h(e)&&t.prepend(e),null===r?b(o):r}}function J(t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(c(e))return e;var n=d(e,T("euc-kr"));return null===n?p(e):[l(n/190)+129,n%190+65]}}function I(t,e){var n=t>>8,i=255&t;return e?[n,i]:[i,n]}function U(r,t){var o=t.fatal,a=null,s=null;this.handler=function(t,e){if(-1===e&&(null!==a||null!==s))return b(o);if(-1===e&&null===a&&null===s)return-1;if(null===a)return a=e,null;var n;if(n=r?(a<<8)+e:(e<<8)+a,(a=null)===s)return m(n,55296,56319)?(s=n,null):m(n,56320,57343)?b(o):n;var i=s;return s=null,m(n,56320,57343)?65536+1024*(i-55296)+(n-56320):(t.prepend(I(n,r)),b(o))}}function H(r,t){t.fatal;this.handler=function(t,e){if(-1===e)return-1;if(m(e,0,65535))return I(e,r);var n=I(55296+(e-65536>>10),r),i=I(56320+(e-65536&1023),r);return n.concat(i)}}function B(t){t.fatal;this.handler=function(t,e){return-1===e?-1:h(e)?e:63360+e-128}}function M(t){t.fatal;this.handler=function(t,e){return-1===e?-1:c(e)?e:m(e,63360,63487)?e-63360+128:p(e)}}Object.defineProperty&&(Object.defineProperty(g.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),Object.defineProperty(g.prototype,"fatal",{get:function(){return"fatal"===this._error_mode}}),Object.defineProperty(g.prototype,"ignoreBOM",{get:function(){return this._ignoreBOM}})),g.prototype.decode=function(t,e){var n;n="object"==typeof t&&t instanceof ArrayBuffer?new Uint8Array(t):"object"==typeof t&&"buffer"in t&&t.buffer instanceof ArrayBuffer?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):new Uint8Array(0),e=s(e),this._do_not_flush||(this._decoder=f[this._encoding.name]({fatal:"fatal"===this._error_mode}),this._BOMseen=!1),this._do_not_flush=Boolean(e.stream);for(var i,r=new u(n),o=[];;){var a=r.read();if(-1===a)break;if(-1===(i=this._decoder.handler(r,a)))break;null!==i&&(Array.isArray(i)?o.push.apply(o,i):o.push(i))}if(!this._do_not_flush){do{if(-1===(i=this._decoder.handler(r,r.read())))break;null!==i&&(Array.isArray(i)?o.push.apply(o,i):o.push(i))}while(!r.endOfStream());this._decoder=null}return function(t){return!function(t,e){return-1!==t.indexOf(e)}(["UTF-8","UTF-16LE","UTF-16BE"],this._encoding.name)||this._ignoreBOM||this._BOMseen||(0<t.length&&65279===t[0]?(this._BOMseen=!0,t.shift()):0<t.length&&(this._BOMseen=!0)),function(t){for(var e="",n=0;n<t.length;++n){var i=t[n];i<=65535?e+=String.fromCharCode(i):(i-=65536,e+=String.fromCharCode(55296+(i>>10),56320+(1023&i)))}return e}(t)}.call(this,o)},Object.defineProperty&&Object.defineProperty(y.prototype,"encoding",{get:function(){return this._encoding.name.toLowerCase()}}),y.prototype.encode=function(t,e){t=t?String(t):"",e=s(e),this._do_not_flush||(this._encoder=a[this._encoding.name]({fatal:"fatal"===this._fatal})),this._do_not_flush=Boolean(e.stream);for(var n,i=new u(function(t){for(var e=String(t),n=e.length,i=0,r=[];i<n;){var o=e.charCodeAt(i);if(o<55296||57343<o)r.push(o);else if(56320<=o&&o<=57343)r.push(65533);else if(55296<=o&&o<=56319)if(i===n-1)r.push(65533);else{var a=t.charCodeAt(i+1);if(56320<=a&&a<=57343){var s=1023&o,l=1023&a;r.push(65536+(s<<10)+l),i+=1}else r.push(65533)}i+=1}return r}(t)),r=[];;){var o=i.read();if(-1===o)break;if(-1===(n=this._encoder.handler(i,o)))break;Array.isArray(n)?r.push.apply(r,n):r.push(n)}if(!this._do_not_flush){for(;-1!==(n=this._encoder.handler(i,i.read()));)Array.isArray(n)?r.push.apply(r,n):r.push(n);this._encoder=null}return new Uint8Array(r)},a["UTF-8"]=function(t){return new v(t)},f["UTF-8"]=function(t){return new e(t)},"encoding-indexes"in i&&t.forEach(function(t){"Legacy single-byte encodings"===t.heading&&t.encodings.forEach(function(t){var e=t.name,n=T(e.toLowerCase());f[e]=function(t){return new w(n,t)},a[e]=function(t){return new x(n,t)}})}),f.GBK=function(t){return new O(t)},a.GBK=function(t){return new C(t,!0)},a.gb18030=function(t){return new C(t)},f.gb18030=function(t){return new O(t)},a.Big5=function(t){return new A(t)},f.Big5=function(t){return new _(t)},a["EUC-JP"]=function(t){return new P(t)},f["EUC-JP"]=function(t){return new R(t)},a["ISO-2022-JP"]=function(t){return new j(t)},f["ISO-2022-JP"]=function(t){return new E(t)},a.Shift_JIS=function(t){return new N(t)},f.Shift_JIS=function(t){return new k(t)},a["EUC-KR"]=function(t){return new J(t)},f["EUC-KR"]=function(t){return new L(t)},a["UTF-16BE"]=function(t){return new H(!0,t)},f["UTF-16BE"]=function(t){return new U(!0,t)},a["UTF-16LE"]=function(t){return new H(!1,t)},f["UTF-16LE"]=function(t){return new U(!1,t)},a["x-user-defined"]=function(t){return new M(t)},f["x-user-defined"]=function(t){return new B(t)},i.TextEncoder||(i.TextEncoder=y),i.TextDecoder||(i.TextDecoder=g),"undefined"!=typeof module&&module.exports&&(module.exports={TextEncoder:i.TextEncoder,TextDecoder:i.TextDecoder,EncodingIndexes:i["encoding-indexes"]})}(this),function(){"use strict";if(!window.rbmIsActive){window.rbmIsActive=!0,Object.keys||(Object.keys=function(t){var e,n=[];if(t!==Object(t))throw new TypeError("Object.keys called on a non-object");for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&n.push(e);return n});var i,r,n,o,a,s,l,c="http://id.tincanapi.com/activity/tags/",u="http://id.tincanapi.com/activitytype/tag",h="http://id.tincanapi.com/extension/quality-rating",p="tags",f="No past statements.",t=TinCan.Utils.getUUID(),e="padding-top: 10px;",d={cache:"overlay",tag:"div",attrs:{id:"rbmOverlay",style:["position: fixed;","z-index: 2147483647;","right: 10px;","top: 10px;","width: 340px;","margin: 0px;","opacity: 0;","font-family: Helvetica, Arial, sans-serif;","font-size: 14px;","line-height: 20px;","color: rgb(51, 51, 51);","background-color: white;","border: 1px solid rgb(51, 51, 51);","border-radius: 4px;","-webkit-box-shadow: 0 1px 1px rgba(0, 0, 0, .5);","box-shadow: 0 1px 1px rgba(0, 0, 0, .5);"].join("")},children:[{tag:"div",attrs:{class:"rbmHeader",style:["border:1px solid #333;","border-bottom: none;", "padding: 10px 30px 10px 10px;","color: black;","background-color: #fff;","border-color: #333;"].join("")},children:[{ tag: "img", attrs: { "class": "logo", "alt": "logo", "src": "https://raw.githubusercontent.com/nagarjundeepak/xAPI/master/images/icons/icon-72x72.png", style: ["width: 30px;"]}, },{tag:"span",attrs:{class:"rbmTitle",style:"font-weight: bold; font-size: 15px; margin-left: 7px;"},text:"LearnED Reporter"},{cache:"closeBtn",tag:"button",attrs:{class:"rbmCloseButton",style:["position: absolute;","right: 11px;","width: 30px;","height: 30px;","cursor:pointer;","border: none;","font-weight: bold;","background: #dc3545;","color: #fff;", "font-size: 12px;", "border-radius: 100%;"].join("")},text:"X"}]},{tag:"div",attrs:{class:"rbmContent",style:"border: 1px solid #333; background-color: aliceblue; padding: 2px 16px 20px 16px;"},children:[{tag:"div",attrs:{class:"rbmContentSection",style:e},children:[{tag:"label",text:"Title: "},{tag:"span",attrs:{class:"rbmObject", style: "padding-left: 0.4em"},text:document.title}]},{tag:"div",attrs:{class:"rbmContentSection",style:e},children:[{tag:"label",attrs: { style: "padding-right: 0.4em"},text:"Status: "},{cache:"verbSelect",tag:"select",attrs:{class:"rbmVerb"}}]},{tag:"div",attrs:{class:"rbmContentSection",style:e},children:[{tag:"label",text:"Rating: "},{cache:"ratingSelect",tag:"select",children:[{tag:"option",attrs:{value:"1"},text:"1"},{tag:"option",attrs:{value:"2"},text:"2"},{tag:"option",attrs:{value:"3",selected:"selected"},text:"3"},{tag:"option",attrs:{value:"4"},text:"4"},{tag:"option",attrs:{value:"5"},text:"5"}]}]},{tag:"div",attrs:{class:"rbmContentSection",style:e},children:[{tag:"div",children:[{tag:"span",text:"Your Tags: "},{tag:"span",children:[{cache:"tagDisplayToggle",tag:"a",attrs:{class:"rbmTagDisplayToggle",href:"#toggle",style:"text-decoration: none;"},html:"&#x229f;"}]}]},{cache:"tags",tag:"div",attrs:{class:"rbmTags"},text:"Loading..."}]},{tag:"div",attrs:{class:"rbmContentSection",style:e},children:[{tag:"label",text:"Selected Tags (space delimited): "},{cache:"tagInput",tag:"input",attrs:{class:"rbmNewTags",style:"box-sizing: border-box; width: 100%;",type:"text"}}]},{tag:"div",attrs:{class:"rbmContentSection",style:"padding: 10px; margin-top: 10px; color: #fff; background-color: #3498db; border: 1px solid #ddd;"},children:[{tag:"div",attrs:{style:"font-weight: bold; "},text:"Statement Preview"},{cache:"previewStatement",tag:"span",attrs:{class:"rbmPreviewStatement"},text:""}]},{tag:"div",attrs:{class:"rbmContentSection",style:"padding: 10px; margin-top: 10px; color: #fff; background-color: #1abc9c; border: 1px solid #ddd;"},children:[{tag:"div",attrs:{style:"font-weight: bold;"},text:"Previous Records"},{cache:"previousRecords",tag:"div",attrs:{class:"rbmPreviousRecords"},text:"Loading..."}]},{tag:"div",attrs:{class:"rbmContentSection",style:e},children:[{cache:"sendStatementBtn",tag:"button",attrs:{class:"rbmSendStatement", style: "cursor:pointer; border: none; padding: 8px; border-radius: 0px; background: #007bff; color: #fff;"},text:"Add to Dashboard"},{cache:"msg",tag:"span",attrs:{class:"rbmMessage",style:"padding-left: 0.5em;"},text:""}]}]}]},g={},y=[{display:"Not Started",id:"http://adlnet.gov/expapi/verbs/launched"},{display:"In Progress",id:"http://adlnet.gov/expapi/verbs/progressed"},{display:"Completed",id:"http://adlnet.gov/expapi/verbs/completed"}],v={},m=["utm_source","utm_medium","utm_term","utm_content","utm_campaign"],b={};i=new TinCan.Activity({id:"http://id.tincanapi.com/recipe/bookmarklet/base/1",definition:{type:"http://id.tincanapi.com/activitytype/recipe"}}),r=new TinCan.LRS({endpoint:window.rbmEndpoint,auth:window.rbmAuth,allowFail:!1}),a=new TinCan.Agent({mbox:window.rbmEmail,name:window.rbmName}),s=new TinCan.Activity({definition:{name:{"en-US":document.title},type:"http://activitystrea.ms/schema/1.0/page"}}),n={actor:a,object:s,context:{registration:t,contextActivities:{category:[i]},extensions:{"http://id.tincanapi.com/extension/browser-info":{code_name:navigator.appCodeName,name:navigator.appName,version:navigator.appVersion,platform:navigator.platform,"user-agent-header":navigator.userAgent,"cookies-enabled":navigator.cookieEnabled}}}},function t(e,n){var i,r,o=document.createElement(e.tag);if(void 0!==e.cache&&(g[e.cache]=o),void 0!==e.attrs)for(i in e.attrs)e.attrs.hasOwnProperty(i)&&o.setAttribute(i,e.attrs[i]);if(void 0!==e.html)o.innerHTML=e.html;else if(void 0!==e.text&&o.appendChild(document.createTextNode(e.text)),void 0!==e.children)for(r=0;r<e.children.length;r+=1)t(e.children[r],o);return n.appendChild(o),o}(d,document.body),function(){var t,e;for(e=0;e<y.length;e+=1)(t=document.createElement("option")).value=y[e].id,t.text=y[e].display,g.verbSelect.add(t)}(),function(){var t,e,n,i,r=TinCan.Utils.parseURL(document.URL);for(i=0;i<m.length;i+=1)void 0!==r.params[m[i]]&&(b[m[i]]=r.params[m[i]],delete r.params[m[i]]);if(t=r.path,0<Object.keys(r.params).length){for(e in t+="?",n=[],r.params)r.params.hasOwnProperty(e)&&n.push(e+"="+encodeURIComponent(r.params[e]));t+=n.join("&")}s.id=t}(),g.closeBtn.addEventListener("click",S,!1),g.sendStatementBtn.addEventListener("click",O,!1),g.tags.addEventListener("click",function(t){t.target&&t.target.classList.contains("rbmTag")&&(t.preventDefault(),function(t){var e,n=g.tagInput.value.split(/[\s,]+/),i=[],r={};for(n.push(t),e=0;e<n.length;e+=1)""!==n[e]&&void 0===r[n[e]]&&(i.push(n[e]),r[n[e]]=!0);i.sort(),g.tagInput.value=i.join(" "),C(),T("")}(t.target.textContent))}),g.tagInput.addEventListener("blur",function(){C(),T("")}),g.verbSelect.addEventListener("change",function(){C(),T("")}),g.ratingSelect.addEventListener("change",function(){C(),T("")}),g.tagDisplayToggle.addEventListener("click",function(t){t.preventDefault(),"block"===window.getComputedStyle(g.tags).display?(g.tags.style.display="none",t.target.innerHTML="&#x229e;"):(g.tags.style.display="block",t.target.innerHTML="&#x229f;")}),C(),r.retrieveState(p,{agent:a,activity:i,callback:function(t,e){null===t?null!==e?(v=e.contents,l=e.etag,w()):g.tags.firstChild.data="<none>":g.tags.firstChild.data="Error loading tags"}}),r.queryStatements({params:{agent:a,activity:s},callback:function(t,e){var n,i=f;if(null===t){if(0<e.statements.length)for(i="",n=0;n<e.statements.length;n+=1)i+=x(e.statements[n]),i+="<br>";g.previousRecords.innerHTML=i}else g.previousRecords.innerHTML="Can't load past statements: "+t}}),setTimeout(function(){!function t(e){e+=.05,(g.overlay.style.opacity=e)<1&&setTimeout(function(){t(e)},75)}(0)},75)}function S(){g.overlay&&(g.overlay.style.display="none",g.overlay.parentNode.removeChild(g.overlay)),delete window.rbmAuth,delete window.rbmEndpoint,delete window.rbmEmail,delete window.rbmName,delete window.rbmIsActive}function T(t){g.msg.firstChild.data=t}function w(){var t,e,n=[],i="";if(null!==v){for(e in v)v.hasOwnProperty(e)&&n.push(e);for(n.sort(),t=0;t<n.length;t+=1)i+=' <a href="'+n[t]+'" class="rbmTag">'+n[t]+"</a>";g.tags.innerHTML=i}else g.tags.firstChild.data="<none>"}function x(t){var e,n,i=[t.actor.toString()," ",t.verb.toString("und"),' "',t.target.toString("en-US"),'" and rated it ',t.context.extensions[h].raw," out of 5"].join("");if(null!==t.timestamp&&(i+=" at "+t.timestamp),i+=".",null!==t.context.contextActivities.other&&0<t.context.contextActivities.other.length){for(i+=" (",e=0;e<t.context.contextActivities.other.length;e+=1)(n=t.context.contextActivities.other[e]).definition.type===u&&(0<e&&(i+=" "),i+=n.toString("und"));i+=")"}return i}function O(){T("Sending statement..."),o.stamp(),r.saveStatement(o,{callback:function(t,e){var n;if(null!==t)return null!==e?void T("Failed to send statement: "+e.responseText+" ("+e.status+")"):void T("Failed to send statement: "+t);T("Statement sent!"),n=(n=g.previousRecords.innerHTML)===f?x(o):x(o)+"<br>"+n,g.previousRecords.innerHTML=n,function(){var e=JSON.stringify(v);r.saveState(p,e,{agent:a,activity:i,contentType:"application/json",lastSHA1:l,callback:function(t){null===t?(l=TinCan.Utils.getSHA1String(e),w()):g.tags.firstChild.data="Error loading tags"}})}()}})}function C(){var t,e=g.tagInput.value;if(n.verb={id:g.verbSelect.value,display:{"en-US":g.verbSelect.options[g.verbSelect.selectedIndex].text}},n.context.extensions[h]={min:1,max:5,raw:Number(g.ratingSelect.value)},""!==e&&0<(e=e.split(/[\s,]+/)).length)for(n.context.contextActivities.other=[],t=0;t<e.length;t+=1)n.context.contextActivities.other.push({id:c+encodeURIComponent(e[t]),definition:{type:u,name:{und:e[t]}}}),v[e[t]]=1;o=new TinCan.Statement(n,{doStamp:!1}),g.previewStatement.firstChild.data=x(o)}}();
